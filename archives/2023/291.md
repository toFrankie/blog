---
title: ç»†è¯» JS | è¯¦è°ˆä¸€ä¸‹ NaN
number: '#291'
link: 'https://github.com/toFrankie/blog/issues/291'
created_at: '2023-02-26 21:04:21'
updated_at: '2024-06-10 19:39:28'
labels:
  - JS
  - '2022'
---
![Freepik](https://upload-images.jianshu.io/upload_images/5128488-d85ecd58f0b6aa59.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


## NaN çš„æ€ªè¯è¡Œä¸ºï¼Ÿ

NaN æ˜¯ Not-A-Number çš„ç®€å†™ï¼Œè¡¨ç¤ºã€Œä¸æ˜¯ä¸€ä¸ªæ•°å­—ã€çš„æ„æ€ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œå®ƒå´æ˜¯ Number ç±»å‹ã€‚

```js
typeof NaN === 'number' // true
```

**å¹³å¸¸æ‰€å†™çš„ `NaN` åªæ˜¯ã€Œå…¨å±€å˜é‡ã€çš„ä¸€ä¸ªã€Œå±æ€§ã€è€Œå·²ï¼Œè¯¥å±æ€§çš„ã€Œåˆå§‹å€¼ã€ä¸º NaNã€‚**

> ä¸ºäº†ä¾¿äºåŒºåˆ†ï¼Œä¸‹æ–‡ä¸­é«˜äº® `NaN` è¡¨ç¤ºå…¨å±€å˜é‡çš„å±æ€§ï¼ŒNaN è¡¨ç¤ºå±æ€§å€¼ã€‚

> ç±»ä¼¼çš„è¿˜æœ‰Â `undefined`ã€`Infinity`ã€`globalThis`ï¼Œå®ƒä»¬éƒ½æ˜¯å…¨å±€å¯¹è±¡å±æ€§ã€‚

å‰é¢æ•…æ„æåˆ° `NaN` çš„åˆå§‹å€¼ä¸º NaNï¼ŒåŸå› æ˜¯åœ¨ ES3 æ—¶ä»£ï¼Œè¯¥å±æ€§æ˜¯å¯ä»¥è¢«è¦†ç›–çš„ï¼Œä¹Ÿå°±æ˜¯ writable çš„ï¼ˆè¿™ç‚¹ä¸ `undefined` è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼‰ï¼Œè‡ª ES5 èµ·å°±ä¸å¯è¢«é‡æ–°èµ‹å€¼äº†ã€‚

> [The value of NaN is *NaN*.](https://262.ecma-international.org/#sec-value-properties-of-the-global-object)

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ**NaN æ˜¯ JavaScript ä¸­å”¯ä¸€ä¸€ä¸ªä¸ç­‰äºå…¶æœ¬èº«çš„å€¼**ã€‚è¿™æ ·çš„è¯ï¼Œå…¨ç­‰æ¯”è¾ƒç»“æœä¸º `false` æ˜¯ä¸æ˜¯çœ‹èµ·æ¥åˆä¹æƒ…ç†äº†ï¼Ÿ

```js
NaN === NaN // false
```

åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œå¯ä»¥å¿«é€Ÿåœ°å†™å‡ºä¸€ä¸ªåˆ¤æ–­æŸä¸ªå€¼æ˜¯å¦ä¸º NaN çš„æ–¹æ³•ï¼š

```js
const myIsNaN = x => x !== x

myIsNaN(NaN) // true
```

å°ç»“ï¼š

* NaN è¡¨ç¤ºä¸€ä¸ªä¸ä¸ºæ•°å­—çš„å€¼ï¼Œä½†å®ƒç±»å‹æ˜¯ Number ç±»å‹ã€‚
* NaN æ˜¯ JavaScript ä¸­å”¯ä¸€ä¸€ä¸ªä¸ç­‰äºå…¶æœ¬èº«çš„å€¼ã€‚
* `NaN === NaN` çš„æ¯”è¾ƒç»“æœä¸º `false`ã€‚

## äºŒã€isNaN()ã€Number.isNaN()ã€Number.NaN å‚»å‚»åˆ†ä¸æ¸…ï¼Ÿ

å…ˆä¸Šå‡ ä¸ªèœå°å°é²œï¼š

```js
NaN == NaN // false
NaN === NaN // false
NaN === Number.NaN // false
```

```js
isNaN(NaN) // true
isNaN('NaN') // true
isNaN('string') // true
isNaN(undefined) // true
isNaN({}) // true
isNaN('11abc') // true
isNaN(new Date().toString()) // true

isNaN(null) // false
isNaN(10) // false
isNaN('10') // false
isNaN('10.2') // false
isNaN('') // false
isNaN(' ') // false
isNaN(new Date()) // false
```
```js
Number.isNaN(NaN) // true
Number.isNaN(Number.NaN) // true
Number.isNaN(0 / 0) // true

Number.isNaN('NaN') // false
Number.isNaN('') // false
Number.isNaN(' ') // false
Number.isNaN(10) // false
Number.isNaN(undefined) // false
Number.isNaN(null) // false
Number.isNaN({}) // false
Number.isNaN(new Date()) // false
Number.isNaN(new Date().toString()) // false
```

å¸Œæœ›ä½ æ²¡æœ‰æ™•ï¼Œå…¶å®æŒæ¡å†…åœ¨åŸç†å°±å¾ˆç®€å•äº†ï¼Œæœ€å¤šæ˜¯ã€Œåç›´è§‰ã€è€Œå·²...

### Number.NaN

å®ƒæ˜¯å†…ç½®å¯¹è±¡ `Number` æä¾›çš„ä¸€ä¸ªã€Œé™æ€å±æ€§ã€ï¼Œå…¶å€¼å°±æ˜¯ NaNï¼Œä¸”ã€Œ**åªè¯»**ã€ã€‚

ä» [ECMAScript 1st Edition #15.7.3.4](https://www.ecma-international.org/wp-content/uploads/ECMA-262_1st_edition_june_1997.pdf) å¯ä»¥çœ‹åˆ°ï¼š

> The value of Number.NaN is *NaN*.
> This property shall have the attributes { DontEnum, DontDelete, ReadOnly }.

è¿™å¤§æ¦‚å°±æ˜¯ä¸å…¨å±€å¯¹è±¡å±æ€§ `NaN` çš„å”¯ä¸€åŒºåˆ«å§ã€‚ 

### isNaN()

å®ƒæ˜¯å…¨å±€å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸º NaNã€‚

ä» [ECMAScript 1st Edition #15.1.2.6](https://www.ecma-international.org/wp-content/uploads/ECMA-262_1st_edition_june_1997.pdf) å¯ä»¥çœ‹åˆ°ï¼š

> Applies *ToNumber* to its argument, then returns true if the result is *NaN*, and otherwise returns false.

ä»è§„èŒƒæè¿°å¯çŸ¥ï¼Œå®ƒå†…éƒ¨åšäº†ã€Œç±»å‹è½¬æ¢ã€ã€‚

ä»¥ `isNaN(x)` ä¸ºä¾‹ï¼Œå®ƒå…ˆå°† `x` è½¬æ¢ä¸º Number ç±»å‹ï¼ˆå³è§„èŒƒä¸­çš„ [ToNumber](https://262.ecma-international.org/#sec-tonumber) æŠ½è±¡æ“ä½œï¼‰ï¼Œç„¶åå†åˆ¤æ–­è½¬æ¢åçš„å€¼æ˜¯å¦ä¸º NaNï¼Œè‹¥ä¸º NaN è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚æ¯”å¦‚ï¼š

```js
const str = 'string'

isNaN(str) // true

// ç›¸å½“äº
const transformedStr = Number(str) // NaN
isNaN(transformedStr) // true
```

è¿™æ ·çš„ç‰¹æ€§æœ‰ä»€ä¹ˆç”¨å‘¢ï¼ŒMDN æ˜¯è¿™æ ·ä»‹ç»çš„ï¼Œè¯·çœ‹[è¿™é‡Œ](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/isNaN#useful_special-case_behavior)ã€‚

åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿå†™å‡ºå…¶ Polyfill æ–¹æ³•ï¼š

```js
globalThis.myIsNaN = function (value) {
  const transformedValue = Number(vulue)
  return transformedValue != transformedValue
}
```

> è‹¥å¯¹æ•°æ®ç±»å‹è½¬æ¢ä¸æ˜¯å¤ªç†Ÿï¼Œå¯ä»¥é˜…è¯»æ–‡ç«  ğŸ‘‰[ï¼ˆéšå¼ï¼‰æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£](https://github.com/toFrankie/blog/issues/242)ã€‚

### Number.isNaN()

ä»å‘½åä¸Šçœ‹ï¼Œ`globalThis.isNaN()` å®ƒæ˜¯åç›´è§‰çš„ï¼Œå®ƒå·å·ç»™æˆ‘ä»¬åšäº†ä¸€æ¬¡ç±»å‹è½¬æ¢ã€‚

å¯èƒ½æ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ‰€ä»¥ ES6 æ ‡å‡†ä¸­æä¾›äº†ä¸€ä¸ªå…¨æ–°çš„æ–¹æ³• `Number.isNaN()`ï¼Œå…¶å†…éƒ¨é€»è¾‘å¦‚ä¸‹ï¼ˆ[å¯çœ‹](https://262.ecma-international.org/#sec-number.isnan)ï¼‰ï¼š

> 1. è‹¥å…¥å‚å€¼ä¸æ˜¯ Number ç±»å‹ï¼Œåˆ™è¿”å› `false`ï¼›
> 2. è‹¥å…¥å‚å€¼ä¸º `NaN` åˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚

ä¸ `isNaN()` ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸ä¼šå¯¹ä¼ å…¥çš„å€¼åšç±»å‹è½¬æ¢ã€‚å› æ­¤ï¼Œå¯ä»¥å¿«é€Ÿå†™å‡ºå…¶ Polyfill æ–¹æ³•ï¼š

```js
Number.myIsNaN = function (value) {
  if (typeof value !== 'number') return false
  return value !== value
}
```

éƒ½ 2022 å¹´äº†ï¼Œéƒ½ç”¨ `Number.isNaN()` æ¥åˆ¤æ–­å§ï¼Œå…¶ä½™çš„å°±äº¤ç»™ Babel äº†ã€‚

### å°ç»“

* `Number.NaN` é™æ€å±æ€§çš„è¿”å›å€¼æ­£æ˜¯ NaN æœ¬èº«ï¼Œè¯¥å±æ€§åªè¯»ã€‚
* åœ¨ ES5 åŠä»¥ä¸Šï¼Œå¯ä»¥è®¤ä¸º `globalThis.NaN` ç­‰ä»·äº `Number.NaN`ï¼Œå®ƒä»¬çš„å€¼å‡ä¸º NaNã€‚
* `isNaN()` æ¯” `Number.isNaN()` å¤šäº†ä¸€ä¸ª `Number()` è¿‡ç¨‹ï¼Œå®é™…é¡¹ç›®ä¸­è‹¥è¦åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸º NaNï¼Œå»ºè®®ä½¿ç”¨åè€…ã€‚

## indexOf() å’Œ includes() å¯¹ NaN æ˜¯å¦‚ä½•åˆ¤æ–­çš„ï¼Ÿ

å…¶å®åœ¨å¦ä¸€ç¯‡æ–‡ç« ã€Š[ç›¸ç­‰æ¯”è¾ƒè¯¦è§£](https://github.com/toFrankie/blog/issues/240)ã€‹å·²ç»ä»‹ç»è¿‡äº†ã€‚

```js
const arr = [NaN]

arr.indexOf(NaN) // -1
arr.includes(NaN) // true
```

ç©¶å…¶åŸå› ï¼Œæ˜¯ç”±äºå…¶å†…éƒ¨ä½¿ç”¨äº†ä¸åŒçš„æ¯”è¾ƒç®—æ³•ã€‚

* [`Array.prototype.indexOf()`](https://262.ecma-international.org/#sec-array.prototype.indexof) ä½¿ç”¨äº†Â [Number::equal (x, y)](https://262.ecma-international.org/#sec-numeric-types-number-equal) ç®—æ³•ã€‚
* [`Array.prototype.includes()`](https://262.ecma-international.org/#sec-array.prototype.includes) ä½¿ç”¨äº† [Number::sameValueZero (x, y)](https://262.ecma-international.org/#sec-numeric-types-number-sameValueZero) ç®—æ³•ã€‚

è¿™ä¿©ç®—æ³•å¯¹ NaN çš„å¤„ç†å¦‚ä¸‹ï¼ˆ[è¯¦è§](https://262.ecma-international.org/#sec-numeric-types-number-equal)ï¼‰ï¼š

![](https://upload-images.jianshu.io/upload_images/5128488-e922050bcbca56ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å¦å¤–ï¼Œ[å…¨ç­‰æ¯”è¾ƒ](https://262.ecma-international.org/#sec-strict-equality-comparison)ä¹Ÿä½¿ç”¨äº† [Number::equal (x, y)](https://262.ecma-international.org/#sec-numeric-types-number-equal) ç®—æ³•ï¼š

![](https://upload-images.jianshu.io/upload_images/5128488-d3b085e0ddd03730.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

> ä¸¤ä¸ª Number ç±»å‹çš„å€¼çš„æ¯”è¾ƒï¼Œå…¶å®éƒ½æ˜¯å›´ç»•äº†è¿™ä¸‰ä¸ªç®—æ³•ï¼š[Number::equal (x, y)](https://262.ecma-international.org/#sec-numeric-types-number-equal)ã€[Number:: sameValue (x, y)](https://262.ecma-international.org/#sec-numeric-types-number-sameValue)ã€[Number::sameValueZero (x, y)](https://262.ecma-international.org/#sec-numeric-types-number-sameValueZero)ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹ä¸‹ã€‚å®ƒä»¬ä¹‹ä¸­æ¯”è¾ƒç‰¹åˆ«çš„å€¼æ— éå°±æ˜¯ `+0`ã€`-0`ã€`NaN`ã€‚

## å…¶ä»–

æ­¤å‰å†™è¿‡ä¸å°‘å…³äº JavaScript æ•°æ®ç±»å‹çš„ä¸€äº›æ–‡ç« ï¼š

* [valueOf å’Œ toString æ–¹æ³•](https://github.com/toFrankie/blog/issues/241)
* [JavaScript çš„è¿·æƒ‘è¡Œä¸ºå¤§èµ](https://github.com/toFrankie/blog/issues/234)
* [ç›¸ç­‰æ¯”è¾ƒè¯¦è§£](https://github.com/toFrankie/blog/issues/240)
* [ï¼ˆéšå¼ï¼‰æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£](https://github.com/toFrankie/blog/issues/242)

The end.
