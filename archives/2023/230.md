---
title: JavaScript åˆ¤æ–­æ˜¯å¦ä¸ºæ•°ç»„
number: '#230'
link: 'https://github.com/toFrankie/blog/issues/230'
created_at: '2023-02-26 18:55:21'
updated_at: '2023-04-26 22:05:21'
labels:
  - JS
  - '2021'
---
JavaScript åˆ¤æ–­æ•°ç»„çš„å‡ ç§æ–¹æ³•åŠå…¶åˆ©å¼Šã€‚

### 1. typeof
å¯¹äº Functionã€Stringã€Numberã€Undefined ç­‰å‡ ç§ç±»å‹çš„å¯¹è±¡æ¥è¯´ï¼Œä»–å®Œå…¨å¯ä»¥èƒœä»»ã€‚ä½†æ˜¯ä¸º Array æ—¶ï¼š

```js
var arr = [1, 2, 3]
console.log(typeof arr) // "object"

// åŒæ ·çš„
console.log(typeof null) // "object"
console.log(typeof {}) // "object"
```

æ‰€ä»¥ä¸èƒ½ä½¿ç”¨ `typeof` æ¥åˆ¤æ–­ã€‚

### 2. instanceof

`instanceof` è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ `prototype` å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚

```js
var arr = [1, 2 ,3]
console.log(arr instanceof Array) // true
```

### 3. åŸå‹é“¾ï¼ˆconstructorï¼‰

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé™¤äº† `undefined` å’Œ `null`ï¼Œå…¶å®ƒéƒ½èƒ½ä½¿ç”¨ `constructor` åˆ¤æ–­ç±»å‹ã€‚

```js
var arr = [1, 2, 3]
console.log(arr.__proto__.constructor === Array) // true
console.log(arr.constructor === Array) // true

// æ³¨æ„ï¼šarr.__proto__ === Array.prototype ä¸º trueã€‚
```
ä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œåˆ¤æ–­æ˜¯ä¸å‡†ç¡®çš„ï¼Œæ¯”å¦‚ï¼š

```js
// æ„é€ å‡½æ•°
function Fn() {}
// ä¿®æ”¹åŸå‹å¯¹è±¡
Fn.prototype = new Array()
// å®ä¾‹åŒ–å¯¹è±¡
var fn = new Fn()

console.log(fn.constructor === Fn) // false
console.log(fn.constructor === Array) // true
// æ­¤æ—¶çš„ fn åº”è¯¥æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œè€Œéæ•°ç»„ï¼Œæ‰€ä»¥æ­¤æ—¶ä½¿ç”¨ constructor åˆ¤æ–­æ˜¯ä¸åˆé€‚çš„ã€‚
```

##### ä½¿ç”¨ instanceof å’Œ constructor çš„å±€é™æ€§ï¼š
> ä½¿ç”¨å’Œå£°æ˜éƒ½å¿…é¡»æ˜¯åœ¨å½“å‰é¡µé¢ï¼Œæ¯”å¦‚çˆ¶é¡µé¢å¼•ç”¨äº†å­é¡µé¢ï¼Œåœ¨å­é¡µé¢ä¸­å£°æ˜äº†ä¸€ä¸ª `Array`ï¼Œå°†å…¶èµ‹å€¼ç»™çˆ¶é¡µé¢çš„ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆæ­¤æ—¶åšåŸå‹é“¾çš„åˆ¤æ–­ï¼š`Array === object.constructor` å¾—åˆ°çš„æ˜¯ `false`ï¼ŒåŸå› å¦‚ä¸‹ï¼š
>
> 1. `Array` å±äºå¼•ç”¨å‹æ•°æ®ï¼Œåœ¨ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œä»…ä»…æ˜¯å¼•ç”¨åœ°å€çš„ä¼ é€’ã€‚
> 2. æ¯ä¸ªé¡µé¢çš„ `Array` åŸç”Ÿå¯¹è±¡æ‰€å¼•ç”¨çš„åœ°å€æ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨å­é¡µé¢å£°æ˜çš„`Array` æ‰€å¯¹åº”çš„æ„é€ å‡½æ•°æ˜¯å­é¡µé¢çš„ `Array` å¯¹è±¡ï¼›çˆ¶é¡µé¢æ¥è¿›è¡Œåˆ¤æ–­ï¼Œä½¿ç”¨çš„ `Array` å¹¶ä¸ç­‰äºå­é¡µé¢çš„ `Array`ã€‚
>
> é™„ä¸Š [Categorizing values in JavaScript](https://2ality.com/2013/01/categorizing-values.html) çš„ä¸€æ®µåŸè¯ï¼š
> `Array.isArray()` exists because of one particular problem in browsers: each frame has its own global environment. An example: Given a frame A and a frame B (where either one can be the document). Code in frame A can pass a value to code in frame B. Then B code cannot use `instanceof Array` to check whether the value is an array, because its B `Array` is different from the A `Array` (of which the value could be an instance). 

çœ‹ä»£ç ï¼š

```js
var iframe = document.createElement('iframe')
document.body.appendChild(iframe)
var xArray = window.frames[window.frames.length - 1].Array
var xarr = new xArray()
var arr = new Array()

// ä¸åŒé¡µé¢ï¼Œç»“æœå¹¶éæˆ‘ä»¬æ‰€é¢„æœŸçš„ trueï¼Œè€Œæ˜¯ false å“¦ï¼
console.log(xarr instanceof Array) // false
console.log(xarr.constructor === Array) // false

// åŒé¡µé¢æ‰æ˜¯ true å“¦ï¼
console.log(arr instanceof Array) // true
console.log(arr.constructor === Array) // true
```


### 4. Array.isArray

é‰´äºä»¥ä¸ŠåŸå› ï¼ŒES5 æ ‡å‡†æä¾›çš„ä¸€ä¸ªåˆ¤æ–­æ•°ç»„æ–¹æ³• `isArray()`ï¼Œå…¶åŸç†ä¹Ÿæ˜¯é€šè¿‡ `Object.prototype.toString()` åˆ¤æ–­å¯¹è±¡çš„å†…éƒ¨å±æ€§ `[[Class]]` æ˜¯å¦ä¸º `"Array"`ï¼Œä»¥è¾¾åˆ°åˆ¤æ–­æ•°ç»„çš„ç›®çš„ã€‚

```js
function isArray(arr) {
  return Array.isArray(arr)
}
```

### 5. Object.prototype.toString

æ‰€ä»¥ï¼Œç»ˆææ–¹æ³•å°±æ˜¯ä»¥ä¸‹è¿™ä¸ª ğŸ‘‡

```js
function isArray(arr) {
  return Object.prototype.toString.call(arr) === '[object Array]'
}
```

### å‚è€ƒ

* [Array.isArray() MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)
* [js å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯ Arrayï¼Ÿ](http://www.nowamagic.net/librarys/veda/detail/1250)
