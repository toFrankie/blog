---
title: ä»é›¶åˆ°ä¸€æ­å»º react é¡¹ç›®ç³»åˆ—ä¹‹ï¼ˆå…­ï¼‰
number: '#59'
link: 'https://github.com/toFrankie/blog/issues/59'
created_at: '2023-02-25 19:35:05'
updated_at: '2023-04-26 21:49:07'
labels:
  - React
  - '2020'
---
åœ¨è®²è§£ **react-hot-loader** ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæŠŠ react å¤§è‡´çš„æ¡†æ¶æ­å»ºå¥½ã€‚åŒ…æ‹¬ **react-router**ã€**redux**ã€**react-redux**ã€**redux-saga** ç­‰ã€‚

æœ¬ç¯‡ä¸»è¦ä»‹ç» **[react-router-v4](https://react-router.docschina.org/)** æ­å»ºã€‚

### é¡¹ç›®ç»“æ„è°ƒæ•´
å¦‚å›¾ï¼Œç›®å‰æ‰€æœ‰æ–°å¢ç›®å½•å¹¶æ²¡æœ‰å†…å®¹ï¼Œä»…è°ƒæ•´äº†å…¥å£æ–‡ä»¶ `index.js` è·¯å¾„ï¼Œä»¥åŠåˆ é™¤äº†ç”¨å¤„ä¸å¤§çš„ `main.js`ã€‚

![](https://upload-images.jianshu.io/upload_images/5128488-d2f595a6c3d836df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


*è°ƒæ•´åï¼Œè¯·ä¿®æ”¹ `webpack.config.js` çš„å…¥å£æ–‡ä»¶ï¼ˆ`entry`ï¼‰è·¯å¾„ï¼Œä»¥åŠä¿®æ”¹ CSS çš„å¯¼å…¥è·¯å¾„ç­‰ï¼Œå¦åˆ™ä¼šç¼–è¯‘å¤±è´¥ã€‚


### react-router æ­å»º
é¦–å…ˆï¼Œæˆ‘ä»¬çš„é¡¹ç›®æ˜¯å•é¡µ Web åº”ç”¨ï¼ˆsimple-page web applicationï¼Œ`SPA`ï¼‰ï¼Œå®ƒè·Ÿæˆ‘ä»¬ä¼ ç»Ÿçš„ä¸€ä¸ªé¡µé¢å¯¹åº”ä¸€ä¸ª HTML ä¸å¤ªä¸€æ ·ã€‚

å•é¡µåº”ç”¨çš„è·¯ç”±è·³è½¬ï¼š
* æµè§ˆå™¨çš„ url å‘ç”Ÿæ”¹å˜ï¼Œä½†å…¶å®å¹¶æ²¡æœ‰å‘é€è¯·æ±‚ï¼Œä¹Ÿæ²¡æœ‰åˆ·æ–°æ•´ä¸ªé¡µé¢ã€‚
* æ ¹æ®æˆ‘ä»¬é…ç½®çš„è·¯ç”±ä¿¡æ¯ï¼Œæ¯æ¬¡åˆ‡æ¢è·¯ç”±ï¼Œä¼šæ ¹æ®é…ç½®æ¥åŠ è½½ä¸åŒçš„ç»„ä»¶ï¼ŒåŒæ—¶ url åœ°å€ä¹Ÿä¼šå‘é€å˜åŒ–ã€‚
* ä¸»è¦æœ‰ `HashRouter` å’Œ `BrowserRouter` ä¸¤ç§æ¨¡å¼ã€‚
* åŸç†å…¶å®å°±æ˜¯ä½¿ç”¨ HTML5 history API æ¥ä½¿ä½ çš„å†…å®¹éšç€ url åŠ¨æ€æ”¹å˜ã€‚

ä¸»è¦è·¯çº¿æ˜¯ï¼š
> **index.html** â†’ **index.js** â†’ **App.js** â†’ **router é…ç½®** â†’ **åŠ è½½æ‰€åŒ¹é…çš„ç»„ä»¶ xxxComponent.js**

æˆ‘ä»¬çš„æ¨¡æ¿ HTML é‡Œé¢æœ‰ä¸ª `<div id="app"></div>` æ ‡ç­¾ä½œä¸ºå®¹å™¨ï¼Œæ¥ç€æˆ‘ä»¬åœ¨å…¥å£æ–‡ä»¶ `index.js` é€šè¿‡ `react-dom` çš„ `render` å‡½æ•°å°†æˆ‘ä»¬çš„ `App.js` ç»„ä»¶æ’å…¥åˆ°å…¶ä¸­ã€‚è€Œ `App.js` å°±æ˜¯æˆ‘ä»¬è·¯ç”±çš„æ ¹ç»„ä»¶ï¼Œç„¶åæˆ‘ä»¬çš„è·¯ç”±ï¼Œåˆæ ¹æ®é…ç½®åŠ è½½å¯¹åº”çš„ `xxxComponent.js` å­ç»„ä»¶ã€‚

##### 1. å®‰è£… react-router-dom
`react-router-dom` åŸºäº `react-router`ï¼ŒåŠ å…¥äº†åœ¨æµè§ˆå™¨è¿è¡Œç¯å¢ƒä¸‹çš„ä¸€äº›åŠŸèƒ½ã€‚æˆ‘ä»¬æ— éœ€å†å®‰è£… `react-router` äº†ï¼Œå› ä¸ºåœ¨ `yarn add react-router-dom` æ—¶ï¼Œå®ƒå°±ä¼šå¸®æˆ‘ä»¬å®‰è£…äº†ã€‚
```shell
$ yarn add react-router-dom@5.2.0
```

##### 2. åˆ›å»º Appã€Homeã€Aboutã€404 ç»„ä»¶
App ç»„ä»¶
```jsx
// App.js
import React, { Component } from 'react'
import { BrowserRouter, HashRouter as Router, Route, Switch, Link } from 'react-router-dom'
import { Home, About, NotFound } from './index'

class App extends Component {
  render() {
    return (
      <Router>
        <Switch>
          <Route path="/" exact component={Home} />
          <Route path="/about" exact component={About} />
          <Route component={NotFound} />
        </Switch>
      </Router>
    )
  }
}

export default App
```
Home ç»„ä»¶
```jsx
// pages/home/index.js
import React, { Component } from 'react'

class Home extends Component {
    constructor(props) {
        super(props)
        this.state = {}
    }

    render() {
        return <div>Home Componentï¼</div>
    }
}

export default Home
```
About ç»„ä»¶
```jsx
// pages/about/index.js
import React, { Component } from 'react'

class About extends Component {
    constructor(props) {
        super(props)
        this.state = {}
    }

    render() {
        return <div>About Componentï¼</div>
    }
}

export default About
```
404 ç»„ä»¶
```jsx
// pages/404.js
import React, { Component } from 'react'
import { Link } from 'react-router-dom'

class NotFound extends Component {
  constructor(props) {
    super(props)
    this.state = {}
  }

  render() {
    return <div>Page not found! <br /> <Link to="/">Go back</Link></div>
  }
}

export default NotFound
```
```js
// pages/index.js
export { default as Home } from './home'
export { default as About } from './about'
export { default as NotFound } from './404'
```
##### 3. ä¿®æ”¹ src/index.jsï¼Œä»¥åŠæ–°å¢ src/Root.js
```jsx
// Root.js
import React from 'react'
import App from './pages/App'

const Root = () => {
  return <App />
}

export default Root
```
```jsx
// index.js
import React from 'react'
import { render } from 'react-dom'
import '../styles/style.css'
import Root from './Root'

// æœ€ç®€å•çš„ React ç¤ºä¾‹
const rootElem = document.getElementById('app')
render(<Root />, rootElem)
```
è¿™é‡Œè®¾è®¡å¤šä¸€å±‚ `Root` æ˜¯ä¸ºäº†åé¢å¼•å…¥ Redux æŠ½ç¦»ä»£ç ï¼Œçœ‹èµ·æ¥æ›´åŠ ç®€æ´ä¸€äº›ã€‚

æœ€ç»ˆç›®å½•ç»“æ„å¦‚ä¸‹ï¼š
![](https://upload-images.jianshu.io/upload_images/5128488-c2b2c498e068df33.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


### è‡³æ­¤ï¼Œæ•ˆæœå‡ºæ¥äº†
å¥½äº†ï¼Œæˆ‘ä»¬çš„ react-router åŸºæœ¬æ­å»ºå¥½äº†ã€‚

åˆ‡æ¢è·¯ç”±ï¼Œhttp://localhost:8080/#/about å°±èƒ½çœ‹åˆ°é¡µé¢åŠ è½½äº† `About Component!`ã€‚
![ğŸ‰](https://upload-images.jianshu.io/upload_images/5128488-ef5461a7255c0428.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
<hr>

### å…³äº react-router ç›¸å…³çš„è¡¥å……è¯´æ˜
1. react-router ç›¸å…³ API å¯¼å…¥é—®é¢˜ï¼š

```jsx
// 1ï¸âƒ£ å†™æ³•ä¸€ï¼ˆæ¨èï¼‰
import { Swtich, Route, Router, HashHistory, Link } from 'react-router-dom'

// 2ï¸âƒ£ å†™æ³•äºŒï¼ŒäºŒè€…æ˜¯ç­‰ä»·çš„
import { Switch, Route, Router } from 'react-router'
import { HashHistory, Link } from 'react-router-dom'

// ************************************************************************
// Why?
// æˆ‘ä»¬ä»æºç é‡Œé¢å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¿™ä¸€æ®µä»£ç ï¼ˆæˆªå–ï¼‰ï¼Œ
// æ¯”å¦‚ Switchï¼Œå®ƒå®é™…ä¸Šå°±æ˜¯å¼•ç”¨äº† react-router çš„ Switch.
// æ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨â€œå†™æ³•ä¸€â€å³å¯
Object.defineProperty(exports, 'Switch', {
  enumerable: true,
  get: function () {
    return reactRouter.Switch;
  }
});
exports.BrowserRouter = BrowserRouter;
exports.HashRouter = HashRouter;
exports.Link = Link;
exports.NavLink = NavLink;
```
