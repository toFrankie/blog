---
title: æ·±ç©¶ Safari ä¸‹ border-radius & overflow ä¸ç”Ÿæ•ˆçš„é—®é¢˜
number: '#178'
link: 'https://github.com/toFrankie/blog/issues/178'
created_at: '2023-02-26 15:55:14'
updated_at: '2023-04-26 22:39:10'
labels:
  - CSS
  - '2023'
---
![é…å›¾æºè‡ª Freepik](https://upload-images.jianshu.io/upload_images/5128488-696ca255e5121991.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


## èƒŒæ™¯

å‰ä¸¤å¤©åœ¨åšéœ€æ±‚çš„æ—¶å€™ï¼Œå‘ç°äº† Safari æµè§ˆå™¨ï¼ˆåŒ…æ‹¬ iOS å¹³å°å„æµè§ˆå™¨ï¼‰ä¸‹æœ‰ä¸€ä¸ªæ¸²æŸ“çš„ Bugï¼Œå…¶ä»–åˆ™æ²¡é—®é¢˜ã€‚

å¤ç°ç¤ºä¾‹å¦‚ä¸‹ï¼š

```html
<div class="box">
  <img src="https://gw.alipayobjects.com/mdn/rms_08e378/afts/img/A*lEtuTZi2GvIAAAAAAAAAAABkARQnAQ" alt="picture" />
</div>
```

```css
.box {
  width: 270px;
  height: 169px;
  margin: 0 auto;
  overflow: hidden;
  border-radius: 30px;
  border: 4px solid #000;
}

.box img {
  width: 100%;
  height: 100%;
  transform: translateZ(10px);
}
```

![](https://upload-images.jianshu.io/upload_images/5128488-50a4e637c93bb388.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
[CodeSandbox Demo](https://codesandbox.io/s/overflow-hidden-border-radius-bu-sheng-xiao-demo-qesus8?file=/index.html)

å…¶å®å°±æ˜¯ç®€å•åœ°åœ¨ `.box` ä¸­æ·»åŠ äº† `overflow: hidden; border-radius: 30px;` åšä¸€ä¸ªåœ†è§’å¤„ç†ã€‚ä¸Šå›¾ä¸ºé¢„æœŸè¡¨ç°ã€‚
ä½†æ˜¯åœ¨ Apple çš„ WebKit å¹³å°ï¼ˆä¸åŒ…å« Chrome çš„ Blink å¹³å°ï¼‰ï¼Œå°±å‡ºç°é—®é¢˜äº† ğŸ‘‡

![](https://upload-images.jianshu.io/upload_images/5128488-eb0e59ac87220290.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ˜¯ overflow: hidden å¤„ç†æ— æ•ˆï¼Ÿè¿˜æ˜¯ border-radius çš„é—®é¢˜ï¼Ÿ

## åŸå› 

è§£å†³æ–¹æ³•å¾ˆå¤šï¼Œæˆ‘ä»¬å…ˆæ·±ç©¶ä¸‹åŸå› ã€‚

å‰é¢ï¼Œæˆ‘ä»¬ç»™ `<img>` æ·»åŠ äº† `transform: translateZ(10px)`ï¼Œäºæ˜¯è¯¥å…ƒç´ äº§ç”Ÿäº† Composite Layerï¼ˆåˆæˆå±‚ï¼‰ã€‚

```css
.box img {
  width: 100%;
  height: 100%;
  transform: translateZ(10px);
}
```

![](https://upload-images.jianshu.io/upload_images/5128488-5682227f829b3855.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è€Œ Webkit å†…æ ¸ä¸­ï¼Œ`border-radius` å¯¹å«æœ‰ Composite Layer çš„å…ƒç´ çš„è£å‰ªæ˜¯å­˜åœ¨ Bug çš„ï¼Œè¯¥é—®é¢˜å¯ä»¥è¿½æº¯åˆ° 2011 å¹´ï¼Œå¾ˆæ—©å°±æœ‰äººæå‡ºé—®é¢˜äº†ã€‚

> [Bug 68196: border-radius clipping of composited layers doesn't work](https://bugs.webkit.org/show_bug.cgi?id=68196)

å‘ç°è¯¥ Bug åœ¨ 2022 å¹´ 9 æœˆ 7 æ—¥å·²è¢«æ ‡è®°ä¸ºã€ŒRESOLVED FIXEDã€ï¼Œåœ¨ 2022 å¹´ 10 æœˆ 19 æ—¥å‘å¸ƒçš„ [Safari Technology Preview 156](https://webkit.org/blog/13394/release-notes-for-safari-technology-preview-156/) ä¸­å·²ä¿®å¤ã€‚å¥½å®¶ä¼™ï¼Œè¿™é—®é¢˜æ•´æ•´åå¤šå¹´æ‰è§£å†³ã€‚

éš”å£ Blink å†…æ ¸ï¼ˆåŸºäº Webkit çš„ä¸€ä¸ªåˆ†æ”¯ï¼‰åˆ™åœ¨ 2017 å¹´ 1 æœˆ 24 æ—¥ä¿®å¤ã€‚

> [Issue 157218: border-radius clipping without a stacking context does not apply to composited children](https://bugs.chromium.org/p/chromium/issues/detail?id=157218)


## è§£å†³æ–¹æ³•

æˆ‘ä»¬åªè¦åœ¨ `border-radius` çš„å…ƒç´ ä¸Šæ·»åŠ ä¸€ä¸ªå¯åˆ›å»º Stacking Contextï¼ˆå±‚å ä¸Šä¸‹æ–‡ï¼‰çš„ CSS å±æ€§å³å¯ã€‚æ¯”å¦‚ `transform: scale(1)`ã€`transform: translateZ(1px)`ã€`isolation: isolate`ã€`position: relative; z-index: 0` ç­‰ç­‰ã€‚

* ä»è¯­ä¹‰è§’åº¦è€ƒè™‘ï¼Œä¸ªäººæ›´åå‘ä½¿ç”¨ [isolation](https://developer.mozilla.org/zh-CN/docs/Web/CSS/isolation)ï¼Œå®ƒè¡¨ç¤ºè¯¥å…ƒç´ æ˜¯å¦å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„å±‚å ä¸Šä¸‹æ–‡ã€‚
* ä»å…¼å®¹æ€§è§’åº¦è€ƒè™‘ï¼Œç›¸æ¯” isolationï¼Œtransform æˆ– position + z-index ä¼šæ›´å¥½ä¸€äº›ã€‚

```css
.box {
  width: 270px;
  height: 169px;
  margin: 0 auto;
  overflow: hidden;
  border-radius: 30px;
  border: 4px solid #000;
  isolation: isolate; /* æ–°å¢ */
}

.box img {
  width: 100%;
  height: 100%;
  transform: translateZ(10px);
}
```

![](https://upload-images.jianshu.io/upload_images/5128488-09e96a5fbf95ba9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



## ç›¸å…³é“¾æ¥

* [border-radius clipping of composited layers doesn't work](https://bugs.webkit.org/show_bug.cgi?id=68196)
* [border-radius clipping of composited layers doesn't work #3883](https://github.com/WebKit/WebKit/pull/3883)
* [Issue 157218: border-radius clipping without a stacking context does not apply to composited children](https://bugs.chromium.org/p/chromium/issues/detail?id=157218)
* [Overflow: hidden with border radius not working on Safari](https://stackoverflow.com/questions/49066011/overflow-hidden-with-border-radius-not-working-on-safari)

