---
title: é’ˆå¯¹ Chrome 80 å’Œ Chrome 91 å¯¹ Cookie SameSite é™åˆ¶çš„è§£å†³æ–¹æ¡ˆ
number: '#247'
link: 'https://github.com/toFrankie/blog/issues/247'
created_at: '2023-02-26 19:32:37'
updated_at: '2023-11-27 14:03:41'
labels:
  - Mac
  - å‰ç«¯
  - Ajax
  - '2020'
---
### ä¸€ã€å‰å› 

> ç”±äºè¿‘æœŸ Chrome æ›´æ–°ï¼ŒåŸæ¥çš„é…ç½®å¤±æ•ˆäº†ï¼Œåˆæ¥æ›´æ–‡äº†ï¼Œå“ ğŸ˜”

æ˜¯è¿™æ ·çš„ã€‚ç”±äºæ­¤å‰æˆ‘çš„ Chrome æµè§ˆå™¨ä¸€ç›´éƒ½æ˜¯å®‰è£…æœ€æ–° Beta ç‰ˆæœ¬ï¼Œä½†æ˜¯æœ‰ä¸€å¤©å› ä¸ºè¯¥æµè§ˆå™¨  Cookie çš„ SameSite å±æ€§çš„é™åˆ¶ï¼ˆChrome 80 ç‰ˆæœ¬ä»¥åï¼‰ï¼Œå¯¼è‡´è·¨åŸŸè¯·æ±‚æ— æ³•æºå¸¦ä¸Š Cookie äº†ï¼Œå¯¼è‡´åœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡é˜»äº†ã€‚

ç”±äºä¸ä¹ æƒ¯åœ¨ Safari æˆ–è€… Firefox æµè§ˆå™¨ä¸Šè¿›è¡Œå¼€å‘ï¼Œä¸»è¦æ˜¯æ“ä½œä¹ æƒ¯ä¸å¤ªä¸€æ ·ï¼Œè€Œä¸”ä¸€äº›æ’ä»¶çš„åŸå› ï¼Œä¹Ÿç”¨ç€ä¸èˆ’æœã€‚å°±æƒ³ç€å…ˆå®‰è£…æ—§ç‰ˆçš„æµè§ˆå™¨ç»§ç»­å¼€å‘ï¼Œåˆ«è€½è¯¯é¡¹ç›®è¿›åº¦ã€‚å½“ç„¶è¿™æ˜¯æƒå®œä¹‹è®¡ã€‚

### äºŒã€è§£å†³æ–¹æ³•

> è‡ª Chrome 80 ç‰ˆæœ¬èµ·ï¼ŒChrome æ›´æ–°äº† SameSite å±æ€§çš„é»˜è®¤å€¼ï¼Œç”± `None` æ”¹æˆäº† `Lax`ï¼Œä¸»è¦ç”¨äºé™åˆ¶ç¬¬ä¸‰æ–¹ Cookieï¼Œå‡å°‘å®‰å…¨é£é™©å’Œç”¨æˆ·è¿½è¸ªã€‚åŒæ—¶ï¼ŒåŸºäº Chromium çš„ Edge æµè§ˆå™¨ï¼Œåœ¨å¯¹åº”ç‰ˆæœ¬ä¹Ÿä¼šæœ‰æ­¤é™åˆ¶å“¦ã€‚

##### æ–¹æ¡ˆä¸€ï¼ˆä¸æ¨èï¼‰

~~å®‰è£… Chrome 80 ä»¥ä¸‹ç‰ˆæœ¬ã€‚~~

##### æ–¹æ¡ˆäºŒï¼šé’ˆå¯¹ Chrome 80 ä»¥ä¸Šï¼ŒChrome 91 ä»¥ä¸‹çš„æµè§ˆå™¨

æµè§ˆå™¨åœ°å€è¾“å…¥ `chrome://flags/` å¹¶å‰å¾€ ï¼Œæœç´¢ [`SameSite by default cookies`](chrome://flags/#same-site-by-default-cookies) å’Œ [`Cookies without SameSite must be secure`](chrome://flags/#cookies-without-same-site-must-be-secure)ï¼Œå°†è¿™ä¸¤é¡¹è®¾ç½®ä¸º `Disabled`ï¼Œç„¶å**é‡å¯æµè§ˆå™¨**ã€‚

##### æ–¹æ¡ˆä¸‰ï¼šé’ˆå¯¹ Chrome 91 åŠæ›´æ–°ç‰ˆæœ¬

è¿‘æœŸå°† Google Chrome å‡çº§åˆ° 91 ç‰ˆæœ¬ä¹‹åï¼Œå°†ä¸Šè¿°æåˆ°çš„ `SameSite by default cookies` å’Œ `Cookies without SameSite must be secure` ç›´æ¥å±è”½å¹¶è®¾ç½®ä¸ºé»˜è®¤å€¼ï¼ˆ`Default`ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åŸæ¥çš„é…ç½®å¤±æ•ˆäº†ï¼Œä¸”å†ä¹Ÿæ— æ³•é€šè¿‡ä¸Šè¿°æ–¹å¼å»ä¿®æ”¹é…ç½®äº†ã€‚

~~å…¶ä¸­ä¸€ä¸ªè§£å†³æ–¹æ³•ï¼Œè¿˜æ˜¯é™çº§åˆ° Chrome 91 ä»¥ä¸‹ï¼ˆä»ç„¶ä¸æ¨èï¼‰ã€‚~~

* Win å¹³å°ï¼š

åœ¨**å®Œå…¨å…³é—­ Chrome æµè§ˆå™¨**çš„å‰æä¸‹ï¼Œæ‰“å¼€ Chrome æµè§ˆå™¨å¿«æ·æ–¹å¼ï¼Œåœ¨**ç›®æ ‡**åæ·»åŠ  `--disable-features=SameSiteByDefaultCookies` ä¿å­˜ã€‚

![](https://upload-images.jianshu.io/upload_images/5128488-daf2645542ccaa23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

> Win å¹³å°æœªäº²æµ‹ï¼Œæ–¹æ¡ˆå’Œé…å›¾æºè‡ªï¼š[NgZaamPaang](https://juejin.cn/post/6967695146322247716)ã€‚

* Mac å¹³å°ï¼š

å‰æè¿˜æ˜¯**å®Œå…¨å…³é—­æµè§ˆå™¨**ï¼Œæ ¹æ®ä¸åŒçš„æµè§ˆå™¨ï¼Œé€‰æ‹©ä¸åŒçš„å¯åŠ¨å‘½ä»¤ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤æ‰“å¼€ã€‚

```shell
# Google Chrome
$ open -a "Google Chrome" --args --disable-features=SameSiteByDefaultCookies

# Microsoft Edge by Chromium
$ open -a "Microsoft Edge" --args --disable-features=SameSiteByDefaultCookies
```

##### æ–¹æ¡ˆå››ï¼šé’ˆå¯¹æœªæ¥ç‰ˆæœ¬ï¼ˆ94 ç‰ˆæœ¬ï¼‰

Chromium é¡¹ç›®å®˜ç½‘æåˆ°åœ¨ 94 ç‰ˆæœ¬é€šè¿‡å‘½ä»¤è¡Œç¦ç”¨è®¾ç½® SameSite é»˜è®¤å€¼çš„æ–¹å¼ä¼šè¢«ç§»é™¤ï¼Œå±Šæ—¶æ–¹æ¡ˆäºŒå’Œæ–¹æ¡ˆä¸‰çš„æ–¹å¼éƒ½å°†æ— æ³•ä½¿ç”¨ï¼Œåç»­å¯é€šè¿‡ Nginx ç­‰ä»£ç†å·¥å…·æˆ–è½¯ä»¶å°†è·¨åŸŸè¯·æ±‚è½¬ä¸ºéè·¨åŸŸè¯·æ±‚æ¥è§£å†³æ”¹é—®é¢˜ã€‚

[å®˜æ–¹æè¿°å¦‚ä¸‹](https://www.chromium.org/updates/same-site)ï¼š

> The flags `#same-site-by-default-cookies` and `#cookies-without-same-site-must-be-secure` have been removed from `chrome://flags` as of Chrome 91, as the behavior is now enabled by default. In Chrome 94, the command-line flag `--disable-features=SameSiteByDefaultCookies,CookiesWithoutSameSiteMustBeSecure` will be removed.


### å››ã€æµè§ˆå™¨ä¸‹è½½

##### Chrome æµè§ˆå™¨
* æœ€æ–°ç¨³å®šç‰ˆï¼š
  [https://www.google.cn/intl/zh-CN/chrome/?standalone=1](https://www.google.cn/intl/zh-CN/chrome/?standalone=1)
  [https://www.google.com/intl/zh-CN/chrome/browser/?standalone=1](https://www.google.com/intl/zh-CN/chrome/browser/?standalone=1)

* æœ€æ–°æµ‹è¯•ç‰ˆï¼š
  [https://www.google.com/intl/zh-CN/chrome/beta/?standalone=1&extra=betachannel](https://www.google.com/intl/zh-CN/chrome/beta/?standalone=1&extra=betachannel)


* æœ€æ–°å¼€å‘ç‰ˆï¼š
[https://www.google.com/intl/zh-CN/chrome/browser/?standalone=1&extra=devchannel](https://www.google.com/intl/zh-CN/chrome/browser/?standalone=1&extra=devchannel)

* æœ€æ–° Canary ç‰ˆï¼š
[https://www.google.com/chrome/canary](https://www.google.com/chrome/canary)

> è¯´æ˜ä¸€ä¸‹ï¼š`standalone=1` å‚æ•°è¡¨ç¤ºç¦»çº¿åŒ…ï¼Œå»æ‰å±äºåœ¨çº¿å®‰è£…ã€‚

**å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸‹è½½å†å²ç‰ˆæœ¬çš„æ€ä¹ˆåŠï¼Ÿ**

> å¯è®¿é—® [Chrome Downloads](https://www.chromedownloads.net/)ï¼Œé‡Œé¢æä¾›äº† Mac/Win ç‰ˆéƒ½æŒºå…¨çš„ã€‚

<!--

è¿™é‡Œæœ‰ä¸ªé€šç”¨çš„ä¸‹è½½åœ°å€ï¼Œä½†æ˜¯å‰ææ˜¯ï¼Œä½ éœ€è¦çŸ¥é“æƒ³è¦ä¸‹è½½çš„å†å²ç‰ˆæœ¬çš„ç‰ˆæœ¬å·ï¼ŒæŒºè›‹ç–¼çš„æ˜¯å¯¹å§ã€‚

> ä¸‹è½½åœ°å€æ˜¯ï¼š`http://dl.google.com/chrome/install/[ç‰ˆæœ¬å·åä¸¤ä½]/chrome_installer.exe`
>
> å‡å¦‚è¦ä¸‹è½½çš„ç‰ˆæœ¬å·æ˜¯ `15.0.874.102`ï¼Œé‚£ä¹ˆåä¸¤ä½å°±æ˜¯ `874.102`ï¼Œè¾“å…¥åœ°å€ï¼š`http://dl.google.com/chrome/install/874.102/chrome_installer.exe` å³å¯ä¸‹è½½ã€‚
> 
> è¯¥æ–¹æ³•ä»…é™äº Win ç‰ˆï¼Œè‡³äº Mac ç‰ˆæ²¡æ‰¾åˆ°æ–¹æ³•ï¼Œæ— å¥ˆã€‚

-->

##### Firefox æµè§ˆå™¨

* æ­£å¼ç‰ˆæœ¬
[https://www.mozilla.org/zh-CN/firefox/](https://www.mozilla.org/zh-CN/firefox/)

* å¼€å‘è€…ä¸­æ–‡ç‰ˆæœ¬ï¼š
[https://www.mozilla.org/zh-CN/firefox/developer/](https://www.mozilla.org/zh-CN/firefox/developer/)
* Beta ç‰ˆã€Nightly ç‰ˆ
[https://www.mozilla.org/zh-CN/firefox/channel/desktop/#beta](https://www.mozilla.org/zh-CN/firefox/channel/desktop/#beta)


### äº”ã€å‚è€ƒ

* [Chrome 91 ç‰ˆæœ¬ SameSite by default cookies è¢«ç§»é™¤åçš„è§£å†³æ–¹æ¡ˆ](https://blog.csdn.net/weixin_46146313/article/details/117707199)
* [Chrome ä¸­è·¨åŸŸ POST è¯·æ±‚æ— æ³•æºå¸¦ Cookie çš„è§£å†³æ–¹æ¡ˆ](https://juejin.cn/post/6967695146322247716)
* [Chrome/Edge 91 ç‰ˆæœ¬ SameSite by default cookies è¢«ç§»é™¤åçš„è§£å†³æ–¹æ¡ˆ](https://gadzan.com/chrome-edge-91hou)
* [Cookie çš„ SameSite å±æ€§ï¼ˆé˜®ä¸€å³°ï¼‰](http://www.ruanyifeng.com/blog/2019/09/cookie-samesite.html)
* [å½“æµè§ˆå™¨å…¨é¢ç¦ç”¨ä¸‰æ–¹ Cookie](https://mp.weixin.qq.com/s?__biz=Mzg2NDAzMjE5NQ%3D%3D&chksm=ce6eccfff91945e990e0b21e777f5a85f3f0699f7d51e45a1dd83d0bf36eaf926f7e90fbe3ff&idx=1&lang=zh_CN&mid=2247485523&scene=21&sn=e7f3989448f5ff1e8905fc6596268e33&token=379611469#wechat_redirect)
