---
title: JavaScript ä¹‹å‡½æ•°é˜²æŠ–ã€èŠ‚æµ
number: '#248'
link: 'https://github.com/toFrankie/blog/issues/248'
created_at: '2023-02-26 19:33:34'
updated_at: '2023-11-27 14:03:48'
labels:
  - ä»£ç ç‰‡æ®µ
  - JS/ES
  - '2021'
---
![é…å›¾æºè‡ª Freepik](https://upload-images.jianshu.io/upload_images/5128488-6a3fda1bfa7ab6ff.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


### ä¸€ã€å‰è¨€

ç›¸ä¿¡æ— è®ºåœ¨å®é™…åº”ç”¨åœºæ™¯ã€äº¦æˆ–æ˜¯é¢è¯•ï¼Œéƒ½ä¼šç»å¸¸é‡å¾—åˆ°å‡½æ•°é˜²æŠ–ã€å‡½æ•°èŠ‚æµç­‰ï¼Œä¸‹é¢æˆ‘ä»¬æ¥èŠä¸€èŠå§ã€‚

å…ˆæ”¾å‡ºä¸€ä¸ªç¤ºä¾‹ï¼š

![](https://upload-images.jianshu.io/upload_images/5128488-ede57838721a5c53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


```jsx
import React, { useEffect, useRef } from 'react'
import debounce from '../../utils/debounce'
import throttle from '../../utils/throttle'
import style from './index.scss'

export default function Demo(props) {
  const inputElem1 = useRef()
  const inputElem2 = useRef()
  const inputElem3 = useRef()

  useEffect(() => {
    inputElem1.current.addEventListener('keyup', request)
    inputElem2.current.addEventListener('keyup', debounce(request, 1000))
    inputElem3.current.addEventListener('keyup', throttle(request, 3000))
  }, [])

  function request(event) {
    const { value } = event.target
    console.log(`Http request: ${value}.`)
  }

  return (
    <div className={style.container}>
      <div className={style.list}>
        <label htmlFor="input1">æ™®é€šè¾“å…¥æ¡†ï¼š</label>
        <input name="input1" ref={inputElem1} defaultValue="" />
      </div>

      <div className={style.list}>
        <label htmlFor="input2">é˜²æŠ–è¾“å…¥æ¡†ï¼š</label>
        <input name="input2" ref={inputElem2} defaultValue="" />
      </div>

      <div className={style.list}>
        <label htmlFor="input3">èŠ‚æµè¾“å…¥æ¡†ï¼š</label>
        <input name="input3" ref={inputElem3} defaultValue="" />
      </div>
    </div>
  )
}
```

ä»¥ä¸Š Demo åªæœ‰ä¸‰ä¸ªè¾“å…¥æ¡†ï¼Œå¾ˆç®€å•ã€‚æˆ‘ç»™æ¯ä¸ªè¾“å…¥æ¡†ç»‘å®šäº†ä¸€ä¸ª `keyup` é”®ç›˜äº‹ä»¶ï¼Œè¯¥äº‹ä»¶æ‰§è¡Œä¼šå‘èµ·ç½‘ç»œè¯·æ±‚ï¼ˆä¸ºäº†æ›´ç®€æ´ï¼Œè¿™é‡Œåªæ˜¯æ‰“å°ä¸€ä¸‹è€Œå·²ï¼‰ï¼Œè€Œå¯¹åº”é˜²æŠ–ã€èŠ‚æµè¾“å…¥æ¡†åˆ™ç»è¿‡ç›¸åº”çš„å¤„ç†ã€‚


### äºŒã€å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰


å¦‚æœæˆ‘ä»¬åœ¨**æ™®é€šè¾“å…¥æ¡†**å¿«é€Ÿé”®å…¥ `12345`ï¼Œå¯ä»¥ä»æ§åˆ¶å°ä¸Šçš„æ‰“å°ç»“æœçœ‹åˆ°ï¼Œå®ƒä¼šå‘èµ· 5 æ¬¡ç½‘ç»œè¯·æ±‚ï¼ˆå‡è®¾æˆ‘ä»¬è¿™ä¸ªæ˜¯ä¸€ä¸ªç®€å•çš„æœç´¢å¼•æ“ï¼‰ã€‚

![](https://upload-images.jianshu.io/upload_images/5128488-ebf48f9d8710729d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

> è¿˜ä¸çŸ¥é“ç”¨ä»€ä¹ˆæˆªå±/å½•å±è½¯ä»¶å¯ä»¥ç”Ÿæˆ GIF åŠ¨å›¾ï¼Œæœ‰æ—¶é—´å†ç ”ç©¶ä¸‹...

ä»å®é™…åœºæ™¯è€ƒè™‘ï¼Œå¦‚æœæ¯é”®å…¥ä¸€ä¸ªå­—ç¬¦å°±ç«‹åˆ»å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå»æ£€ç´¢ç»“æœï¼Œè¿™æ˜¯éå¸¸å½±å“ä½“éªŒçš„ã€‚å‡è®¾æˆ‘ä»¬é™åˆ¶ä¸ºï¼š**ç”¨æˆ·åœ¨åœæ­¢è¾“å…¥å 1s åæ‰å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚**

è¦å®ç°è¿™æ ·çš„éœ€æ±‚ï¼Œæˆ‘ä»¬åªæœ‰ä½¿ç”¨å‡½æ•°é˜²æŠ–å³å¯ã€‚

##### 2.1 ä»€ä¹ˆæ˜¯å‡½æ•°é˜²æŠ–ï¼Ÿ

æ¦‚å¿µï¼šåœ¨ä¸€å®šæ—¶é—´é—´éš”å†…ï¼Œäº‹ä»¶å¤„ç†å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚è‹¥åœ¨è¯¥æ—¶é—´é—´éš”å†…ï¼ˆå¤šæ¬¡ï¼‰é‡æ–°è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚

æ€ä¹ˆç†è§£ï¼Ÿ

* å‡è®¾ç”¨æˆ·é”®å…¥å­—æ¯ `a` åå°±åœæ­¢è¾“å…¥äº†ï¼Œé‚£ä¹ˆç½‘ç»œè¯·æ±‚ä¼šåœ¨åœæ­¢é”®å…¥æ“ä½œçš„ 1s åå‘èµ·ã€‚è¿™ä¸ªå¾ˆå¥½ç†è§£ã€‚
* è‹¥ç”¨æˆ·ç»§ç»­é”®å…¥å­—æ¯ `b` åï¼Œè‹¥æœ‰æ‰€æ€åœ°åœäº†ä¸€ä¼šï¼ˆè¿™ä¸ªæ—¶é—´åœ¨ 1s ä¹‹å†…ï¼Œå‡è®¾ä¸º 800ms å§ï¼‰ï¼Œæ¥ç€é”®å…¥å­—æ¯ `c`ï¼Œä¹‹åå°±åœæ­¢é”®å…¥äº†ã€‚**ç½‘ç»œè¯·æ±‚ä¼šå‘ç”Ÿåœ¨é”®å…¥å­—æ¯ `c` çš„ 1s åè¢«å‘èµ·ï¼Œè€Œä¸æ˜¯é”®å…¥å­—æ¯ `b` ä¹‹åçš„ 1s å‘èµ·ã€‚**å› ä¸ºå‡½æ•°é˜²æŠ–ä¼šåœ¨é”®å…¥ `c` ä¹‹åé‡æ–°è®¡æ—¶ã€‚


##### 2.2 å‡½æ•°é˜²æŠ–å®ç°

> debounce(func, wait)

å®ç°æ€è·¯ï¼š

é¦–å…ˆï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•° `func`ï¼ˆè¦é˜²æŠ–çš„å‡½æ•°ï¼Œä¸€èˆ¬æ˜¯äº‹ä»¶å›è°ƒå‡½æ•°ï¼‰å’Œ `wait`ï¼ˆéœ€è¦å»¶è¿Ÿçš„æ—¶é—´é—´éš”ï¼Œå•ä½æ¯«ç§’ï¼‰ã€‚ç„¶å `func` åœ¨ `setTimeout` ä¸­æ‰§è¡Œï¼Œè€Œ `setTimeout` çš„å»¶è¿Ÿæ—¶é—´å°±æ˜¯ `wait`ã€‚è€Œé‡æ–°è®¡æ—¶çš„è¯ï¼Œåˆ™åœ¨æ¯æ¬¡è§¦å‘çš„æ—¶å€™ `clearTimeout` å³å¯å®ç°ã€‚

> éœ€è¦æ³¨æ„ä¸‹ï¼Œ`func` çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆ`this`ï¼‰åŠå…¶å…¥å‚ã€‚

```js
// debounce.js
function debounce(func, wait) {
  let timerId
  return function () {
    // å½“å‰è¿è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä»¥åŠå®å‚
    const context = this
    const args = arguments

    // é‡æ–°è®¡æ—¶ï¼ˆå…³é”®æ˜¯è¿™ä¸€æ­¥ï¼‰
    // åœ¨ wait æ—¶é—´å†…ï¼Œè‹¥é‡æ–°è§¦å‘ï¼Œæ¸…é™¤ clearTiemoutï¼Œä»¥è¾¾åˆ°é‡æ–°è®¡æ—¶çš„æ•ˆæœ
    if(timerId) clearTimeout(timerId)

    timerId = setTimeout(function () {
      // ç»‘å®šä¸Šä¸‹æ–‡å’Œå‚æ•°ï¼Œå¦åˆ™å®å‚ func çš„ this æŒ‡å‘ window å¯¹è±¡ï¼Œå‚æ•°ä¸ºç©º
      func.apply(context, args)
    }, wait)
  }
}
```

å€ŸåŠ© ES6 çš„ [Rest å‚æ•°](https://es6.ruanyifeng.com/#docs/function#rest-å‚æ•°)å’Œ[ç®­å¤´å‡½æ•°](https://es6.ruanyifeng.com/#docs/function#ç®­å¤´å‡½æ•°)è¯­æ³•ï¼Œç®€åŒ–ä¸€ä¸‹ï¼š

```js
function debounce(func, wait) {
  let timerId
  return function (...args) {
    if (timerId) clearTimeout(timerId)
    timerId = setTimeout(() => {
      func.apply(this, args)
    }, wait)
  }
}
```

ä¾æ¬¡åœ¨å¯¹åº”è¾“å…¥æ¡†å†…é”®å…¥ `12345`ï¼Œå¯¹æ¯”ä¸‹é˜²æŠ–å‰åçš„ç»“æœï¼š

> ä¸¤æ¬¡é”®å…¥é€Ÿåº¦å·®ä¸å¤šï¼Œè€Œä¸”æ¯ä¸ªå­—ç¬¦é”®å…¥æ—¶é—´é—´éš”å°äº 1sï¼ˆå¯è°ƒå¤§å»¶è¿Ÿæ‰§è¡Œæ—¶é—´ï¼Œæ›´å®¹æ˜“å¯¹æ¯”ï¼‰ã€‚

```js
// æ™®é€šè¾“å…¥æ¡†
inputElem1.current.addEventListener('keyup', request)
// é˜²æŠ–è¾“å…¥æ¡†
inputElem2.current.addEventListener('keyup', debounce(request, 1000))
```

![æ— é˜²æŠ–å¤„ç†](https://upload-images.jianshu.io/upload_images/5128488-bc20f9a38399e74f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![é˜²æŠ–å¤„ç†](https://upload-images.jianshu.io/upload_images/5128488-e3fc1bdd25c1eedb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å¯¹æ¯”ä»¥ä¸Šæ— é˜²æŠ–å¤„ç†å’Œé˜²æŠ–å¤„ç†çš„ç»“æœï¼Œå¯ä»¥çœ‹åˆ°å‰è€…æ¯é”®å…¥ä¸€ä¸ªå­—ç¬¦éƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè€Œåè€…åˆ™ä¼šåœ¨æœ€åä¸€æ¬¡è§¦å‘çš„ N æ¯«ç§’ï¼ˆå³ `wait` å»¶è¿Ÿæ—¶é—´ï¼‰ä¹‹åæ‰ä¼šæ‰§è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ã€‚

> è¿˜æœ‰ä¸€ç§æ˜¯**â€œç«‹å³æ‰§è¡Œâ€**çš„å‡½æ•°é˜²æŠ–ï¼šåŒºåˆ«åœ¨äºç¬¬ä¸€æ¬¡è§¦å‘æ—¶ï¼Œæ˜¯å¦ç«‹å³æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚

å†ç»“åˆä»¥ä¸Šçš„**â€œéç«‹å³æ‰§è¡Œâ€**çš„é˜²æŠ–ï¼Œå®Œæ•´æ–¹æ³•å¦‚ä¸‹ï¼š

```js
/**
 * å‡½æ•°é˜²æŠ–
 * @param {Function} func è¦é˜²æŠ–çš„å‡½æ•°
 * @param {number} wait éœ€è¦å»¶è¿Ÿçš„æ¯«ç§’æ•°
 * @param {boolean} immediate æ˜¯å¦ç«‹å³æ‰§è¡Œ
 * @returns {Function} è¿”å›æ–°çš„ debouncedï¼ˆé˜²æŠ–åŠ¨ï¼‰å‡½æ•°
 */
function debounce(func, wait = 0, immediate = false) {
  let timerId
  return function (...args) {
    if (timerId) clearTimeout(timerId)

    if (immediate && !timerId) {
      func.apply(this, args)
    }

    timerId = setTimeout(() => {
      func.apply(this, args)
    }, wait)
  }
}
```

å½“æˆ‘ä»¬ä¿®æ”¹æˆï¼š

```js
inputElem2.current.addEventListener('keyup', debounce(request, 1000, true))
```

ä»ä»¥ä¸‹ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘åœ¨é˜²æŠ–è¾“å…¥æ¡†é”®å…¥ `12345` çš„æ—¶å€™ï¼Œå®ƒä¼šåœ¨é”®å…¥ `1` æ—¶ç«‹åˆ»å‘èµ·ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œç”±äºæ¯ä¸ªå­—ç¬¦é”®å…¥çš„æ—¶é—´é—´éš”éƒ½åœ¨ `1s` ä¹‹å†…ï¼Œå› æ­¤å®ƒåªä¼šåœ¨æœ€ååœæ­¢é”®å…¥çš„ `1s` åæ‰ä¼šå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

![](https://upload-images.jianshu.io/upload_images/5128488-9283f5bf6ffb4897.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)




### ä¸‰ã€å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰

æ¦‚å¿µï¼šåœ¨ä¸€å®šæ—¶é—´é—´éš”å†…åªä¼šè§¦å‘ä¸€æ¬¡å‡½æ•°ã€‚è‹¥åœ¨è¯¥æ—¶é—´é—´éš”å†…è§¦å‘å¤šæ¬¡å‡½æ•°ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ç”Ÿæ•ˆã€‚

##### 3.1 å‡½æ•°èŠ‚æµå®ç°

```js
function throttle(func, wait) {
  // è®°å½•ä¸Šä¸€æ¬¡æ‰§è¡Œ func çš„æ—¶é—´
  let prev = 0
  return function (...args) {
    // å½“å‰è§¦å‘çš„æ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
    const now = Number(new Date()) // +new Date()
    
    // å•ä½æ—¶é—´å†…åªä¼šæ‰§è¡Œä¸€æ¬¡
    if (now >= prev + wait) {
      // ç¬¦åˆæ¡ä»¶æ‰§è¡Œ func æ—¶ï¼Œéœ€è¦æ›´æ–° prev æ—¶é—´
      prev = now
      func.apply(this, args)
    }
  }
}
```

##### 3.2 å‡½æ•°èŠ‚æµä¼˜åŒ–

ä»¥ä¸ŠèŠ‚æµæ–¹æ³•æœ‰ä¸ªé—®é¢˜ï¼Œå‡è®¾èŠ‚æµæ§åˆ¶é—´éš”æ—¶é—´ä¸º 1sï¼Œè‹¥æœ€åä¸€æ¬¡è§¦å‘æ—¶é—´åœ¨ 1.5sï¼Œåˆ™æœ€åä¸€æ¬¡è§¦å‘å¹¶ä¸ä¼šæ‰§è¡Œã€‚å› æ­¤ï¼Œéœ€è¦åœ¨èŠ‚æµä¸­åµŒå…¥é˜²æŠ–æ€æƒ³ï¼Œä»¥ä¿è¯æœ€åä¸€æ¬¡ä¼šè¢«è§¦å‘ã€‚

```js
function throttle(func, wait) {
  // è®°å½•ä¸Šä¸€æ¬¡æ‰§è¡Œ func çš„æ—¶é—´
  let prev = 0
  let timerId
  return function (...args) {
    // å½“å‰è§¦å‘çš„æ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
    const now = Number(new Date()) // +new Date()

    // ä¿è¯æœ€åä¸€æ¬¡ä¹Ÿä¼šè§¦å‘
    // æˆ‘çœ‹åˆ°å¾ˆå¤šæ–‡ç« ï¼Œå°†æ¸…é™¤å®šæ—¶å™¨çš„æ­¥éª¤æ”¾åˆ° 2ï¸âƒ£ é‡Œé¢
    // æˆ‘è®¤ä¸ºåº”è¯¥æ”¾åœ¨è¿™é‡Œæ‰å¯¹ï¼ŒåŸå› çœ‹æˆ‘ä¸‹é¢ä¸¾ä¾‹çš„åœºæ™¯ã€‚
    if (timerId) clearTimeout(timerId)
    
    if (now >= prev + wait) {
      // 1ï¸âƒ£
      // ç¬¦åˆæ¡ä»¶æ‰§è¡Œ func æ—¶ï¼Œéœ€è¦æ›´æ–° prev æ—¶é—´
      prev = now
      func.apply(this, args)
    } else {
      // 2ï¸âƒ£
      // å•ä½æ—¶é—´å†…åªä¼šæ‰§è¡Œä¸€æ¬¡
      // if (timerId) clearTimeout(timerId) // ä¸åº”è¯¥æ”¾åœ¨è¿™é‡Œ
      timerId = setTimeout(() => {
        prev = now
        func.apply(this, args)
      }, wait)
    }
  }
}
```

å‡è®¾æˆ‘å°† `clearTimeout()` æ”¾åœ¨äº† 2ï¸âƒ£ é‡Œé¢ï¼Œè€Œä¸æ˜¯åœ¨å¤–å±‚ã€‚åŸºäº `throttle(func, 1000)` è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼š

> æˆ‘åœ¨ `4s` æ—¶è§¦å‘äº†ä¸€æ¬¡ï¼Œåº”è¯¥èµ° 1ï¸âƒ£ é€»è¾‘ã€‚ç„¶ååœ¨ `4.9s` æ—¶åˆè§¦å‘äº†ä¸€æ¬¡ï¼Œè¿™ä¼šèµ°çš„ 2ï¸âƒ£ é€»è¾‘å¹¶è®°å½•äº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ã€‚ç„¶åæ—¶é—´åˆ°äº† `5s`ï¼Œæˆ‘åˆè§¦å‘äº†ä¸€æ¬¡ï¼ˆåé¢å°±åœæ­¢æ“ä½œäº†ï¼‰ï¼Œå®ƒä¼šèµ° 1ï¸âƒ£ é€»è¾‘ä¸€æ¬¡ï¼Œæ¥ç€æ—¶é—´æ¥çš„ `5.9s`ï¼Œå®ƒè¿˜ä¼šæ‰§è¡Œä¸€é `fn.apply(this, args)`ï¼Œå› ä¸ºåœ¨ `5s` è§¦å‘æ—¶ï¼Œæ²¡æœ‰ `clearTimeout()`ã€‚å› æ­¤ï¼Œæ¸…é™¤å®šæ—¶å™¨çš„æ­¥éª¤åº”è¯¥æ”¾åœ¨å¤–å±‚ï¼Œä»¥ä¿è¯æ¯æ¬¡è¢«è§¦å‘æ˜¯éƒ½æ¸…æ‰æœ€åä¸€æ¬¡çš„å®šæ—¶å™¨ï¼Œé¿å…åœ¨ä¸€äº›è¾¹ç•Œ Case è§¦å‘ä¸¤æ¬¡ã€‚

å½“ç„¶ï¼Œä»¥ä¸Šåœºæ™¯æ˜¯åœ¨ç†æƒ³çš„çŠ¶æ€ï¼Œå®é™…åœºæ™¯å¯èƒ½å‡ ä¹ç¢°ä¸åˆ°è¿™äº›è¾¹ç•Œã€‚ä½†ä»ä¸¥è°¨çš„è§’åº¦å»çœ‹é—®é¢˜ï¼Œåº”è¯¥ä¹Ÿè¦è€ƒè™‘çš„ã€‚

> å†™åˆ°è¿™é‡Œï¼Œæˆ‘åˆåœ¨æƒ³åˆšåˆšçš„â€œç«‹å³æ‰§è¡Œçš„å‡½æ•°é˜²æŠ–â€ï¼Œè·Ÿè¿™ä¸ªä¼˜åŒ–ç‰ˆçš„èŠ‚æµæ˜¯ä¸æ˜¯æœ‰ç‚¹åƒï¼Œç¬¬ä¸€æ¬¡è§¦å‘éƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚ä½†åŒºåˆ«æ˜¯é˜²æŠ–ä¼šé‡æ–°è®¡æ—¶ï¼Œè€ŒèŠ‚æµåœ¨ç¬¬ä¸€æ¬¡è§¦å‘åé¢çš„æ¯ä¸ªé—´éš”æ—¶é—´ç‚¹éƒ½ä¼šè§¦å‘ï¼Œéé—´éš”ç‚¹çš„æœ€åä¸€æ¬¡è§¦å‘ä¹Ÿå°†ä¼šè¢«æ‰§è¡Œã€‚

æˆ‘åœ¨èŠ‚æµè¾“å…¥æ¡†å†…ï¼Œä¾æ¬¡é”®å…¥ `1234567890`ï¼Œå¯ä»¥çœ‹åˆ°ï¼šåœ¨é”®å…¥å­—ç¬¦ `1` æ—¶æ‰§è¡Œäº†å›è°ƒï¼›æ¥ç€é”®å…¥çš„ `234`ã€`67` å­—ç¬¦éƒ½å±åœ¨ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”å†…ï¼Œå› æ­¤æ— æ³•æ‰§è¡Œå›è°ƒã€‚å…¶ä¸­é”®å…¥çš„ `90` å­—ç¬¦åº”å±äº `8` ä¹‹åçš„ 1s å‘¨æœŸä¹‹å†…ï¼Œç”±äºé”®å…¥ `0` å­—ç¬¦å±äºæœ€åä¸€æ¬¡çš„éæ—¶é—´é—´éš”å†…çš„è§¦å‘åŠ¨ä½œï¼Œå› æ­¤å›è°ƒä¼šåœ¨é”®å…¥ `0` çš„ 1s åè¢«æ‰§è¡Œã€‚ï¼ˆå¯æ‰“å°æ—¶é—´æˆ³çš„å½¢å¼ï¼Œæ›´ç²¾ç»†åœ°å¯¹æ¯”ï¼‰

```js
inputElem3.current.addEventListener('keyup', throttle(request, 1000))
```

![èŠ‚æµå¤„ç†](https://cdn.jsdelivr.net/gh/toFrankie/blog/images/1677411328715.png)

### å››ã€é˜²æŠ–ä¸èŠ‚æµ

å…¶å®ï¼Œå‡½æ•°é˜²æŠ–å’Œå‡½æ•°èŠ‚æµéƒ½æ˜¯ä¸ºäº†é˜²æ­¢æŸä¸ªæ—¶é—´æ®µé¢‘ç¹è§¦å‘æŸä¸ªäº‹ä»¶ã€‚å®ƒä¿©åœ¨æŸä¸ªæ—¶é—´é—´éš”å†…å¤šæ¬¡é‡å¤è§¦å‘ï¼Œéƒ½åªä¼šæ‰§è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ã€‚åŒºåˆ«åœ¨äºå‡½æ•°é˜²æŠ–æœ€åä¸€æ¬¡è§¦å‘æœ‰æ•ˆï¼Œè€Œå‡½æ•°èŠ‚æµåˆ™æ˜¯ç¬¬ä¸€æ¬¡è§¦å‘æœ‰æ•ˆã€‚

è€Œåœ¨ä¸Šé¢ï¼Œéƒ½å¯¹å‡½æ•°é˜²æŠ–å’Œå‡½æ•°èŠ‚æµåšäº†**â€œæ‹“å±•â€**ï¼Œä¾‹å¦‚ï¼š

* åœ¨å‡½æ•°é˜²æŠ–ä¸­ï¼Œå¢åŠ äº† `immediate` çš„å‚æ•°ï¼Œç”¨äºæ§åˆ¶ç¬¬ä¸€æ¬¡æ˜¯å¦æ‰§è¡Œå›è°ƒã€‚
* åœ¨å‡½æ•°èŠ‚æµä¸­ï¼Œå…è®¸æœ€åä¸€æ¬¡åœ¨éæ—¶é—´é—´éš”çš„è§¦å‘åŠ¨ä½œæœ‰æ•ˆã€‚

åº”ç”¨åœºæ™¯ï¼š

* å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰
  * æœç´¢åœºæ™¯ï¼šé˜²æ­¢ç”¨æˆ·ä¸åœåœ°è¾“å…¥ï¼Œæ¥èŠ‚çº¦è¯·æ±‚èµ„æºã€‚
  * window resizeï¼šè°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°æ—¶ï¼Œåˆ©ç”¨é˜²æŠ–ä½¿å…¶åªè§¦å‘ä¸€æ¬¡ã€‚

* å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰
  * é¼ æ ‡äº‹ä»¶ã€mousemove æ‹–æ‹½
  * ç›‘å¬æ»šåŠ¨äº‹ä»¶

å¦‚æœè¿˜æ˜¯ä¸å¤ªæ˜ç™½ debounce å’Œ throttle çš„å·®å¼‚ï¼Œå¯ä»¥åœ¨ä»¥ä¸‹è¿™ä¸ª[é¡µé¢](http://demo.nimius.net/debounce_throttle/)ï¼Œå¯è§†åŒ–ä½“éªŒã€‚

![](https://upload-images.jianshu.io/upload_images/5128488-330d7d9d8983b0ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



### äº”ã€æ‹“å±•

è¿˜æ˜¯é‚£å¥è¯ï¼š

> ç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ Lodash åº“ï¼Œå¯¹åº”çš„æ–¹æ³•æ˜¯ [_.debounce()](https://www.lodashjs.com/docs/lodash.debounce) å’Œ [_.throttle()](https://www.lodashjs.com/docs/lodash.throttle)ã€‚

æ¯•ç«Ÿ Lodash æ˜¯ç»è¿‡ç¤¾åŒºè€ƒéªŒçš„ï¼Œè‚¯å®šä¼šå®Œå–„å¾ˆå¤šã€‚è€Œæˆ‘è¿™ç¯‡æ–‡ç« å¯èƒ½ä¼šæœ‰ä¸€äº›æˆ‘æœªæ›¾æƒ³åˆ°çš„åœºæ™¯æ²¡æœ‰å¤„ç†çš„ï¼Œé¢å‘å­¦ä¹ å’Œé¢è¯•ï¼ˆæ‰‹åŠ¨ç‹—å¤´ï¼‰ã€‚

å¦‚æœ‰ä¸è¶³ï¼Œæ¬¢è¿æŒ‡å‡º ğŸ‘‹ ~

**TODO List:**

* è¯¦ç»†é˜…è¯» Lodash çš„[é˜²æŠ–](https://github.com/lodash/lodash/blob/master/debounce.js)å’Œ[èŠ‚æµ](https://github.com/lodash/lodash/blob/master/throttle.js)æºç ã€‚
* [window.requestAnimationFrame](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame)


### å…­ã€å‚è€ƒ

* [Lodash debounce](https://github.com/lodash/lodash/blob/master/debounce.js)
* [å‡½æ•°é˜²æŠ–ä¸å‡½æ•°èŠ‚æµï¼ˆå¸å¾’æ­£ç¾å¤§ä½¬ï¼‰](https://zhuanlan.zhihu.com/p/38313717)
