---
title: macOS ç»ˆç«¯ç¾åŒ–ä¸ zsh å¤šè®¾å¤‡é…ç½®åŒæ­¥å…±äº«
number: '#28'
link: 'https://github.com/toFrankie/blog/issues/28'
created_at: '2023-02-25 18:59:23'
updated_at: '2024-05-14 14:13:52'
labels:
  - Mac
  - Terminal
  - '2022'
---
<!--
![](https://upload-images.jianshu.io/upload_images/5128488-296beb21cddd78c8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
-->

![é…å›¾æºè‡ª Freepik](https://upload-images.jianshu.io/upload_images/5128488-1166a1634ff00f8b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

## å‰è¨€

ç”±äºä¸ªäººå¯¹ iTerm2 ç­‰ç¬¬ä¸‰æ–¹ç»ˆç«¯å·¥å…·ä¸å¤ªæ„Ÿå†’ï¼Œå› æ­¤ä¸€ç›´åœ¨ç”¨ç³»ç»Ÿå†…ç½®ç»ˆç«¯ã€‚ç›¸æ¯”é‚£äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ï¼Œç³»ç»Ÿè‡ªå¸¦çš„ Terminal å¯è°“æ˜¯ç®€é™‹å•Šã€‚

ä»Šå¤©ï¼Œç»ˆäºæœ‰ç©ºæŠ˜è…¾ä¸€ä¸‹å®ƒäº†ï¼Œé»˜è®¤é•¿è¿™æ · ğŸ‘‡

![](https://upload-images.jianshu.io/upload_images/5128488-59d7cf9e6c859a81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

## ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ zshï¼Ÿ

åœ¨ Unix-like æ“ä½œç³»ç»Ÿä¸­ä¾›é€‰æ‹©çš„ Shell è§£æå™¨ç§ç±»æœ‰å¾ˆå¤šï¼Œæœ€å¸¸è§çš„æ˜¯ bash å’Œ zshã€‚

ç›¸è¾ƒä¹‹ä¸‹ï¼Œzsh ä¸»è¦æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š

* å®Œå…¨å…¼å®¹ bashï¼Œå› æ­¤ `!# /bin/bash` è¿™ç±»è„šæœ¬ä¹Ÿæ˜¯å®Œç¾æ”¯æŒçš„ã€‚
* æ›´å¼ºå¤§çš„ Tab è¡¥å…¨ã€‚
* æ›´æ™ºèƒ½çš„ç›®å½•åˆ‡æ¢ã€‚
* å‘½ä»¤é€‰é¡¹è¡¥å…¨ã€‚
* æ–‡ä»¶ã€ç›®å½•å¤§å°å†™è‡ªåŠ¨æ›´æ­£ï¼ˆæœ€æœ€æœ€ç›´è§‚çš„æ„Ÿå—ï¼Œå¤ªæ–¹ä¾¿äº†ï¼‰ã€‚
* ä¸°å¯Œçš„ä¸»é¢˜ã€æ’ä»¶ï¼ˆOh My Zshï¼‰
* å¯æŸ¥çœ‹å‘½ä»¤è¾“å…¥å†å²è®°å½•ã€‚

æ€»çš„æ¥è¯´ï¼ŒTab å¤§æ³•å¥½ï¼Œæœ‰äº‹æ²¡äº‹ Tab ä¸€ä¸‹ï¼Œå¯ä»¥å¸®ä½ çœæ‰å¾ˆå¤šå‘½ä»¤çš„è¾“å…¥ã€‚

> è‡ª macOS 10.15 èµ·ï¼Œç³»ç»Ÿä½¿ç”¨ zsh ä½œä¸ºé»˜è®¤ Shellã€‚å¦‚æœä½ è¿˜åœ¨ç”¨ bashï¼Œå¯å‚è€ƒã€Œ[åœ¨ Mac ä¸Šå°† zsh ç”¨ä½œé»˜è®¤ Shell](https://links.jianshu.com/go?to=https%3A%2F%2Fsupport.apple.com%2Fzh-cn%2FHT208050)ã€ä¸€æ–‡è¿›è¡Œè¿ç§»ã€‚

## Oh My Zsh

zsh çš„åŠŸèƒ½å¾ˆå¤šï¼Œä½†æ˜¯é…ç½®è¾ƒä¸ºç¹çï¼Œè¯¦ç»†é…ç½®è¯·çœ‹ [Archlinux Zsh](https://wiki.archlinux.org/title/Zsh)ã€‚

ä½†æ˜¯ï¼ŒRobby Russell å¼€å‘çš„ [Oh My Zsh](https://github.com/ohmyzsh/ohmyzsh/) é¡¹ç›®æå¤§åœ°æ”¹å˜äº†é…ç½®ç¹ççš„ç°è±¡ï¼Œè€Œä¸”å¸¦æ¥äº†å¼ºå¤§çš„æ’ä»¶å’Œä¸»é¢˜åŠŸèƒ½ã€‚

### å®‰è£…
```shell
$ sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
```
å®‰è£…å®Œæˆåï¼Œå®ƒè¢«å­˜æ”¾äº `~/.oh-my-zsh` ç›®å½•ï¼Œåœ¨é‡Œé¢æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å®ƒæä¾›çš„ä»»ä½•æ’ä»¶ã€ä¸»é¢˜ç­‰ã€‚

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å‰çš„ `~/.zshrc` é…ç½®æ–‡ä»¶ä¼šè¢«é‡å‘½åä¸º `~/.zshrc.pre-oh-my-zsh`ã€‚è‹¥æœ‰éœ€è¦ï¼Œå¯å°†æ­¤å‰çš„é…ç½®é‡æ–°æ·»åŠ åˆ° `~/.zshrc` é‡Œé¢ã€‚

### å¯ç”¨æ’ä»¶

Oh My Zsh æä¾›çš„æ’ä»¶å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šï¼Œè¯¦è§ [Plugins Wiki](https://github.com/ohmyzsh/ohmyzsh/wiki/Plugins)ã€‚å¦‚éœ€å¯ç”¨æŸæ’ä»¶ï¼Œåªéœ€åœ¨ `~/.zshrc` å¼•å…¥å³å¯ã€‚å¤šä¸ªæ’ä»¶ä¹‹é—´ä½¿ç”¨ã€Œç©ºç™½ç¬¦ã€éš”å¼€ï¼Œä½†ä¸èƒ½ç”¨é€—å· `,` éš”å¼€ï¼Œå¦åˆ™ä¼šè¢«ä¸­æ–­ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œä»¥ä¸‹å°†ä¼šæŒ‰é¡ºåºå¯ç”¨ nvmã€gitã€ruby æ’ä»¶ã€‚

```shell
plugins=(nvm git ruby)
```

### åˆ‡æ¢ä¸»é¢˜

Oh My Zsh æä¾›äº†è¶…è¿‡ 150 ç§ä¸»é¢˜ï¼Œé»˜è®¤ä¸»é¢˜æ˜¯ [robbyrussell](https://github.com/ohmyzsh/ohmyzsh/wiki/Themes#robbyrussell)ï¼Œè¯¦è§ [Themes Wiki](https://github.com/ohmyzsh/ohmyzsh/wiki/Themes)ã€‚åŒæ ·åœ°ï¼Œå¦‚éœ€é…ç½®ä¸»é¢˜ï¼Œåˆ™æ·»åŠ åˆ° `~/.zshrc` é‡Œé¢ã€‚

```shell
ZSH_THEME="robbyrussell"
```

å®ƒè¿˜æä¾›äº†ä¸€äº›èŠ±é‡Œèƒ¡å“¨çš„é…ç½®ï¼Œæ¯”å¦‚éšæœºä¸»é¢˜ã€‚

```shell
# æ¯æ‰“å¼€ä¸€ä¸ªæ–°çš„ Shell çª—å£ï¼Œéšæœºé€‰æ‹©å†…ç½®çš„ä¸»é¢˜ã€‚
ZSH_THEME="random"

# æˆ–è€…ä»å¤šä¸ªå€™é€‰ä¸»é¢˜ä¸­éšæœºå±•ç¤ºã€‚
ZSH_THEME_RANDOM_CANDIDATES=(
  "robbyrussell"
  "agnoster"
)

# ç”šè‡³å¯ä»¥æ’é™¤æ‰ä¸å–œæ¬¢çš„ä¸»é¢˜ï¼Œè¿™æ ·å°±ä¸ä¼šåœ¨éšæœºä¸»é¢˜ä¸­å‡ºç°ã€‚
ZSH_THEME_RANDOM_IGNORED=(pygmalion tjkirch_mod)
```

## Terminal Theme

ç³»ç»Ÿå†…ç½®çš„ç»ˆç«¯å·¥å…·é»˜è®¤ä¸»é¢˜ã€ŒBasicã€æ˜¯ç™½åº•é»‘å­—çš„ã€‚è™½ç„¶ä¹Ÿå†…ç½®äº†å‡ ç§ä¸»é¢˜ä¾›é€‰æ‹©ï¼Œä½†æ¶ä¸ä½å®ƒä¸‘å•Šã€‚

ä¿®æ”¹å‘½ä»¤æç¤ºç¬¦

```shell
PROMPT="%(?:%{$fg_bold[green]%}â†’ â—:%{$fg_bold[red]%}â†’ â—)%{$fg_bold[white]%}â—"
PROMPT+=" %{$fg_bold[yellow]%}%c %{$reset_color%}$ "
RPROMPT="[%{$fg[white]%}%*%{$reset_color%}]"
```

å¦‚æœç³»ç»Ÿæ˜¯æµ…è‰²æ¨¡å¼ï¼Œæ­¤æ—¶ vim èƒŒæ™¯è‰²ä»ç„¶æ˜¯ç™½åº•ï¼Œå¯ä»¥åœ¨ `~/.vimrc` ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œè¿™æ ·ä¸»é¢˜å°±éƒ½ç»Ÿä¸€äº†ã€‚

```shell
set background=dark "è®¾ç½®èƒŒæ™¯è‰²
```

æœ€ç»ˆæ•ˆæœ ğŸ‘‡

![](https://cdn.jsdelivr.net/gh/toFrankie/blog@main/images/2024/5/1715667003269.png)

è¯¦è§ï¼š[terminal-dark-theme](https://github.com/toFrankie/terminal-dark-theme.git) â­ï¸

## é…ç½®åŒæ­¥

ç”±äºæˆ‘è¿™è¾¹æœ‰ MacBook Pro å’Œ iMac ä¸¤ä¸ªè®¾å¤‡ï¼Œé‚£ä¹ˆè®¾å¤‡é—´åŒæ­¥å°±æ˜¾å¾—å¾ˆé‡è¦äº†ï¼Œå¯ä»¥çœå»ä¿®æ”¹å…¶ä¸€è®¾å¤‡é…ç½®ï¼Œéœ€è¦æ‹·è´åˆ°å¦ä¸€è®¾å¤‡ä»¥åŒæ­¥æ›´æ–°çš„éº»çƒ¦ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬çš„ zsh é…ç½®éƒ½æ˜¯ç”¨æˆ·çº§åˆ«çš„ï¼Œä¹Ÿå°±æ˜¯å­˜æ”¾åœ¨ `~` ç›®å½•ä¸‹ï¼š

```shell
~/.zshrc
```

### å¦‚ä½•åšé…ç½®åŒæ­¥å…±äº«å‘¢ï¼Ÿ

æ€è·¯éå¸¸ç®€å•ï¼š

> 1. å°†é…ç½®æ–‡ä»¶å­˜æ”¾äº iCloud äº‘ç›˜ï¼Œå¯å¤šè®¾å¤‡åŒæ­¥ã€‚
> 2. åœ¨æœ¬åœ°é…ç½®ä¸­å¼•å…¥ iCloud äº‘ç›˜åŒæ­¥çš„é…ç½®æ–‡ä»¶ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ iCloud äº‘ç›˜åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œæ¯”å¦‚ `Terminal`ã€‚

```shell
$ cd ~/Library/Mobile\ Documents/com~apple~CloudDocs
$ mkdir Terminal
```
ç„¶åï¼Œå°† `~/.zshrc` æ‹·è´è‡³ `Terminal` ç›®å½•ï¼Œå¹¶é‡å‘½åä¸º `zshrc.sh`ã€‚

```shell
$ cp ~/.zshrc ~/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc.sh
```

ä»¥ä¸Šåˆ›å»ºç›®å½•ã€æ‹·è´ã€é‡å‘½åç­‰æ“ä½œå¯ç›´æ¥åœ¨ Finder ä¸­å®Œæˆã€‚

æ¥ç€ï¼Œä¿®æ”¹æœ¬åœ°çš„ `~/.zshrc`ï¼Œå¯ä»¥ç§»é™¤æ‰é‡Œé¢åŸå…ˆçš„é…ç½®ï¼Œç„¶åå†™å…¥ä¸€è¡Œé…ç½®å³å¯ï¼š`source $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc.sh`ï¼Œå¯ç›´æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®Œæˆï¼š

```shell
$ echo 'source $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc.sh' > ~/.zshrc
```
æ‰€ä»¥ `~/.zshrc` é…ç½®æ–‡ä»¶å°±å˜æˆäº†ï¼š

```shell
source $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc.sh
```

`source` å‘½ä»¤ç”¨äºæ‰§è¡Œä¸€ä¸ªè„šæœ¬ï¼Œé€šå¸¸ç”¨äºé‡æ–°åŠ è½½ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚

æœ€åï¼Œåˆ·æ–°ä¸‹ `~/.zshrc` é…ç½®æ–‡ä»¶ã€‚

```shell
$ source ~/.zshrc
```

åœ¨å…¶ä»–è®¾å¤‡ä¸‹ï¼Œåªè¦ä¿®æ”¹ä¸€æ¬¡æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œå¹¶åˆ·æ–°é…ç½®å³å¯ã€‚

### é…ç½®æ‹†åˆ†

å‰é¢åšé…ç½®åŒæ­¥çš„åˆè¡·æ˜¯è§£å†³å¤šè®¾å¤‡çš„åœºæ™¯ï¼Œå¦ä¸€æ–¹é¢æ˜¯å¯ä»¥åšå¤‡ä»½ï¼Œä¸‹æ¬¡æ¢æœºå™¨å¯çœå»é…ç½®çš„éº»çƒ¦ã€‚

æ—¢ç„¶æ˜¯å¤šè®¾å¤‡ï¼Œé‚£ææœ‰å¯èƒ½å„è®¾å¤‡çš„ç¯å¢ƒæ˜¯ä¸ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯é…ç½®ä¼šæœ‰æ‰€ä¸åŒã€‚åŸºäºæ­¤åœºæ™¯ï¼Œç›´æ¥é‡‡ç”¨ä¸Šè¿°æ–¹å¼æ˜¾ç„¶æ˜¯ä¸å¦¥çš„ã€‚å‡è®¾è®¾å¤‡ A å®‰è£…äº† nvmï¼Œç„¶ååœ¨ iCloud äº‘ç›˜  `Terminal/zshrc.sh` é‡Œæ·»åŠ äº†å¯¹åº”çš„é…ç½®ï¼Œè€Œè®¾å¤‡ B æ˜¯æ²¡æœ‰å®‰è£… nvm çš„ï¼Œä½†ç”±äº B å…±äº«äº†é…ç½®ï¼Œåœ¨ B è®¾å¤‡ä¸­æ‰§è¡Œ `souce ~/.zshrc` å°±ä¼šå¯¼è‡´å‡ºé”™ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬è¦å¯¹ `Terminal/zshrc.sh` é…ç½®è¿›è¡Œæ‹†åˆ†ï¼š

```shell
~/Library/Mobile Documents/com~apple~CloudDocs/Terminal/
â”œâ”€â”€ zshrc.sh            # ç»Ÿä¸€å¼•å…¥ä»¥ä¸‹ç»†åˆ†é…ç½®
â”œâ”€â”€ zshrc-common.sh     # å„è®¾å¤‡å…±åŒé…ç½®ï¼Œæ¯”å¦‚ Oh-My-Zsh çš„ä¸€äº›é…ç½®ç­‰
â”œâ”€â”€ zshrc-imac.sh       # iMac è®¾å¤‡ç‰¹æœ‰é…ç½®
â””â”€â”€ zshrc-mbp.sh        # MacBook Pro è®¾å¤‡ç‰¹æœ‰é…ç½® 
```
ğŸ‘† ä»¥ä¸ŠæŒ‰è‡ªä¸ªå®é™…æƒ…å†µæ‹†åˆ†ã€‚è¿™é‡Œæ–‡ä»¶åä¸ä»¥ `.` å¼€å¤´çš„åŸå› æ˜¯ä¸æƒ³éšè—æ–‡ä»¶ï¼Œæ¯•ç«Ÿå®ƒä¸å­˜åœ¨äºæœ¬åœ°ç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹ï¼Œæ²¡å¿…è¦éšè—äº†ã€‚å¦å¤–ï¼Œæ‰©å±•åæ˜¯å¯çœç•¥çš„ï¼Œç”šè‡³å¯éšæ„è‡ªå®šä¹‰ã€‚ç”±äº `~/.zshrc` æœ¬èº«å°±æ˜¯ä¸€ä¸ª Shell è„šæœ¬ï¼Œè€Œ Shell è„šæœ¬æ‰©å±•åæ˜¯å¯é€‰çš„ã€‚ä½†æŒ‰ä¹ æƒ¯ï¼Œå¤šå°†å…¶å®šä¹‰ä¸º `.sh`ï¼ŒåŠ ä¹‹ä¸»æµç¼–è¾‘å™¨å¯¹æ­¤æ‰©å±•åä¸€èˆ¬éƒ½æœ‰è¯­æ³•é«˜äº®ã€‚

### æŒ‰è®¾å¤‡å¼•å…¥å¯¹åº”é…ç½®

é¦–å…ˆï¼Œæˆ‘ä»¬ç°åœ¨ `Terminal/zshrc.sh` å¼•å…¥ `zshrc-common.sh` å…±åŒçš„é…ç½®æ–‡ä»¶ã€‚

```shell
# zshrc.sh

# åŠ è½½å…±åŒé…ç½®
source $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc-common.sh

# åŠ è½½è®¾å¤‡ç‰¹æœ‰é…ç½®
# è€Œä¸”åº”æ”¾åœ¨å…±åŒé…ç½®åé¢åŠ è½½ï¼ŒåŸåˆ™ä¸Šå®ƒä»¬çš„ä¼˜å…ˆçº§åº”è¯¥è¾ƒé«˜çš„ã€‚
# ...
```

æ¥ç€ï¼Œè¦è§£å†³æŒ‰è®¾å¤‡å¼•å…¥å„è‡ªç‰¹æœ‰çš„é…ç½®æ–‡ä»¶ã€‚ç”¨ä»¥ä¸‹å‡ ç§æ–¹æ³•æ¥åŒºåˆ†è®¾å¤‡ï¼š

```shell
$ hostname
Frankies-iMac.local

$ scutil --get LocalHostName
Frankies-iMac

$ scutil --get ComputerName
Frankie's iMac
```
å¯¹åº”å¦‚ä¸‹ï¼š

![](https://upload-images.jianshu.io/upload_images/5128488-41b6c5449fb94d1a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å…¶ä¸­ `LocalHostName` æ˜¯ `ComputerName` æ ¼å¼åŒ–ä¹‹åçš„åç§°ï¼Œæ¯”å¦‚ç©ºæ ¼ä¼šæ›¿æ¢ä¸ºè¿å­—ç¬¦ `-`ï¼Œä¸€äº›ç‰¹æ®Šç¬¦å·ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚`hostname` åˆ™æ˜¯åœ¨ `LocalHostName` åŠ ä¸Š `.local` çš„åç§°ã€‚ä½†ç”±äº hostname è¯»å–é¡ºåºçš„é—®é¢˜ï¼ˆ[è¯¦è§](https://shockerli.net/post/macos-hostname-scutil/)ï¼‰ï¼Œå®ƒå¯èƒ½ä¼šå—åˆ°æ‰€è¿æ¥ç½‘ç»œçš„å½±å“ï¼Œå› æ­¤å®ƒå¯èƒ½ä¸æ˜¯å›ºå®šå€¼ã€‚

åŸºäºä»¥ä¸Šè€ƒè™‘ï¼Œè¿™é‡Œä½¿ç”¨ `scutil --get ComputerName` å‘½ä»¤ï¼Œå®ƒçš„è¿”å›å€¼å–å†³äºä½ è¾“å…¥çš„ç”µè„‘åç§°ã€‚ä½†æ³¨æ„ `ComputerName` ä¸º macOS ç‹¬æœ‰ã€‚

æ¥ç€ï¼Œç¼–å†™ä¸€ä¸ª Shell å‡½æ•°ï¼ŒæŒ‰è®¾å¤‡ç”µè„‘åç§°åŠ è½½å¯¹åº”é…ç½®ã€‚

```shell
# æ ¹æ®è®¾å¤‡ç”µè„‘åç§°ï¼Œè¯»å–å¯¹åº”é…ç½®
function load_device_zsh_configuration() {
  local computer_name=$(scutil --get ComputerName)
  local icloud_config_dir="$HOME/Library/Mobile Documents/com~apple~CloudDocs/Terminal"
  if [[ $computer_name =~ 'MacBook' ]]; then
    local config_file="$icloud_config_dir/zshrc-mbp.sh"
    if [ -f "$config_file" ]; then
      source "$config_file"
    fi
  elif [[ $computer_name =~ 'iMac' ]]; then
    local config_file="$icloud_config_dir/zshrc-imac.sh"
    if [ -f "$config_file" ]; then
      source "$config_file"
    fi
  fi
}
load_device_zsh_configuration
unset -f load_device_zsh_configuration
```

ğŸ‘† ä»¥ä¸Šå‡ ä¸ªåœ°æ–¹æŒ‰éœ€è°ƒæ•´ã€‚ä¸€æ˜¯ `icloud_config_dir` åé¢çš„ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ iCloud äº‘ç›˜ä¸­å­˜æ”¾é…ç½®æ–‡ä»¶çš„ç›®å½•ã€‚äºŒæ˜¯ç±»ä¼¼  `$computer_name =~ 'MacBook'` è¿™è¡Œï¼Œæ„æ€æ˜¯å½“ `ComputerName` ä¸­åŒ…å« `MacBook` å­—ç¬¦ä¸²æ—¶ï¼Œæ‰§è¡Œ `if` è¯­å¥ï¼Œå°†åŠ è½½ `zshrc-mbp.sh` é…ç½®ã€‚

å› æ­¤ï¼Œ`zshrc.sh` çš„é…ç½®å¦‚ä¸‹ï¼š

```shell
# Load zsh common configuration
source $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc-common.sh

# Load device zsh configuration
function load_device_zsh_configuration() {
  local computer_name=$(scutil --get ComputerName)
  local icloud_config_dir="$HOME/Library/Mobile Documents/com~apple~CloudDocs/Terminal"
  if [[ $computer_name =~ 'MacBook' ]]; then
    local config_file="$icloud_config_dir/zshrc-mbp.sh"
    if [ -f "$config_file" ]; then
      source "$config_file"
    fi
  elif [[ $computer_name =~ 'iMac' ]]; then
    local config_file="$icloud_config_dir/zshrc-imac.sh"
    if [ -f "$config_file" ]; then
      source "$config_file"
    fi
  fi
}
load_device_zsh_configuration
unset -f load_device_zsh_configuration
```

### ä¸€æ¬¡å¤±è´¥çš„å°è¯•ä¸æ€è€ƒ

æœ€åˆï¼Œæˆ‘æœ‰ä¸€ç§åˆ©ç”¨é“¾æ¥æ–‡ä»¶ç‰¹æ€§çš„æ€è·¯ï¼š

> å°† `Terminal/zshrc.sh` ä¸ `~/.zshrc` å»ºç«‹ç¡¬é“¾æ¥å…³ç³»ï¼Œæ­¤æ—¶ä¸¤è€…å°±æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„åŒä¸€æ–‡ä»¶ï¼ˆinode å·ç ç›¸åŒï¼‰ï¼Œä¿®æ”¹å…¶ä¸­ä¸€æ–¹ï¼Œå¦ä¸€æ–¹ä¼šåŒæ­¥ä¿®æ”¹ã€‚è€Œä¸”åˆ é™¤ä»»æ„ä¸€æ–¹ï¼Œå¯¹å¦ä¸€æ–¹ä¸ä¼šäº§ç”Ÿå½±å“ã€‚

ä½†æ˜¯ï¼Œç”±äº iCloud äº‘ç›˜ä¸­çš„æ–‡ä»¶ä¼šè¿›è¡ŒåŒæ­¥æ“ä½œã€‚æ®æˆ‘è§‚å¯Ÿï¼Œå½“æ–‡ä»¶åŒæ­¥å®Œæˆä¹‹åï¼Œå°½ç®¡æ–‡ä»¶åä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œä½† inode å·ç ä¼šå‘ç”Ÿå˜åŒ–çš„ã€‚è¿™æ ·çš„è¯ï¼Œä¼šå¯¼è‡´å‰é¢å»ºç«‹çš„ç¡¬é“¾æ¥å…³ç³»ç ´è£‚ï¼Œå³ `Terminal/zshrc.sh` ä¸ `~/.zshrc` çš„ inode ä¸å†ç›¸åŒï¼Œä¿®æ”¹ä»»æ„ä¸€æ–¹ï¼Œå¦ä¸€æ–¹éƒ½ä¸ä¼šåŒæ­¥ä¿®æ”¹ã€‚å› æ­¤ï¼ŒåŸºäºç¡¬é“¾æ¥çš„æ€è·¯æ˜¯ä¸è¡Œçš„ã€‚

ç„¶åï¼Œæˆ‘åˆèŒç”Ÿäº†å¦ä¸€ç§æ€è·¯ï¼šåˆ©ç”¨è½¯é“¾æ¥æ–‡ä»¶ã€‚è½¯é“¾æ¥æ–‡ä»¶çš„æ–‡ä»¶å†…å®¹å­˜æ”¾çš„æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œå‰é¢ iCloud åŒæ­¥ä¸ä¼šå½±å“æ–‡ä»¶åï¼Œå› æ­¤çœ‹èµ·æ¥ä¼¼ä¹æ˜¯å¯è¡Œçš„ï¼š

```shell
# åˆ›å»º Terminal/zshrc.sh çš„è½¯é“¾æ¥è‡³ ~/.zshrc.icloud
$ ln -s ~/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc.sh ~/.zshrc.icloud

# åœ¨ ~/.zshrc å†™å…¥é…ç½®
$ echo 'source ~/.zshrc.icloud' > ~/.zshrc

# åˆ·æ–°é…ç½®
$ souce ~/.zshrc
```

ğŸ‘† ä»¥ä¸Šåœ¨ `~/.zshrc` åŠ è½½ `~/.zshrc.icloud` çš„æ—¶å€™ï¼Œç”±äºåè€…æ˜¯ `Terminal/zshrc.sh` çš„è½¯é“¾æ¥ï¼Œå‘½ä»¤æ‰§è¡Œæ—¶ä¼šæ‰¾åˆ° `Terminal/zshrc.sh` çš„å†…å®¹è¿›è¡ŒåŠ è½½ã€‚

è¿™ç§æ–¹æ¡ˆçœ‹ç€æ˜¯å¯è¡Œçš„ï¼Œä½†å±å®æœ‰ç‚¹å¤šæ¬¡ä¸€ä¸¾äº†ã€‚ä½•ä¸ç›´æ¥åœ¨ `~/.zshrc` åŠ è½½ `Terminal/zshrc.sh` å‘¢ï¼Ÿ

> è‹¥å¯¹ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥æ–‡ä»¶ç‰¹æ•ˆä¸å¤ªäº†è§£çš„è¯ï¼Œå¯çœ‹ [Linux é“¾æ¥æ–‡ä»¶è¯¦è§£](https://github.com/toFrankie/blog/issues/36)ã€‚


### å…¶ä»–

å®Œæˆä»¥ä¸Šå¤šè®¾å¤‡åŒæ­¥ã€é…ç½®å…±äº«ä¹‹åï¼Œåç»­é…ç½®è°ƒæ•´ï¼Œåº”æ ¹æ®å®é™…æƒ…å†µå¯¹ä»¥ä¸‹æ–‡ä»¶ä½œå‡ºä¿®æ”¹ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹ `~/.zshrc` æœ¬åœ°é…ç½®ã€‚

```shell
~/Library/Mobile Documents/com~apple~CloudDocs/Terminal/
â”œâ”€â”€ zshrc-common.sh
â”œâ”€â”€ zshrc-imac.sh
â””â”€â”€ zshrc-mbp.sh
```

ç”±äº iCloud äº‘ç›˜çš„ `Terminal` ç›®å½•ä¸å¥½è®°ï¼Œè¿˜é•¿ï¼ŒåŠ ä¹‹å®¹æ˜“å¿½ç•¥ `Mobile\ Documents` ç©ºæ ¼çš„é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `zshrc-common.sh` è®¾ç½®ä¸€äº›å˜é‡æˆ–åˆ«åä»¥å¿«é€Ÿå®šä½åˆ°é…ç½®æ–‡ä»¶ã€‚ä»¥ä¸‹ä»…ä¾›å‚è€ƒï¼š

```shell
# zshrc-common.sh

# åˆ·æ–°æœ¬åœ°é…ç½®
alias sourcez="source ~/.zshrc"

# è®¾ç½®åˆ«åï¼Œå¯å¿«é€Ÿæ‰“å¼€å„é…ç½®æ–‡ä»¶
alias openz-common="open $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc-common.sh"
alias openz-imac="open $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc-imac.sh"
alias openz-mbp="open $HOME/Library/Mobile\ Documents/com~apple~CloudDocs/Terminal/zshrc-mbp.sh"

# è®¾ç½®å˜é‡ï¼Œå¯ç›´æ¥é€šè¿‡ `cd $ICLOUD_TERMINAL_DIR` å‘½ä»¤æ‰“å¼€ç›®å½•
export ICLOUD_TERMINAL_DIR="$HOME/Library/Mobile Documents/com~apple~CloudDocs/Terminal"
```

è¿™æ ·çš„è¯ï¼Œæ¯”å¦‚è¦å¾€ `zshrc-imac.sh` ä¸­æ·»åŠ é…ç½®ï¼Œå¯ä»¥è¿™æ ·ï¼š

```shell
# æ‰“å¼€ zshrc-imac.sh é…ç½®æ–‡ä»¶
$ openz-imac

# å¾€ zshrc-imac.sh é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œé…ç½®ï¼šexport CUR_DEVICE="Frankie's iMac"

$ åˆ·æ–°é…ç½®
# soucez

# æµ‹è¯•ä¸€ä¸‹
$ echo $CUR_DEVICE
Frankie's iMac
```

ç”šè‡³ï¼Œå¯ä»¥ç»™æ¯ä¸ªé…ç½®æ–‡ä»¶è®¾ç½®ä¸€ä¸ªå˜é‡ `Configuration_File_Name`ï¼Œç„¶ååˆ©ç”¨ç±»ä¼¼ `echo 'some configuration' >> $Configuration_File_Name` å½¢å¼å¾€é…ç½®æ–‡ä»¶ä¸­è¿½åŠ é…ç½®ã€‚è¯·è‡ªè¡Œå‘æŒ¥ã€‚

The end.
