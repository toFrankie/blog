---
title: åˆè¯• Yarn Workspaces
number: '#282'
link: 'https://github.com/toFrankie/blog/issues/282'
created_at: '2023-02-26 20:50:04'
updated_at: '2023-04-26 22:28:14'
labels:
  - Node.js
  - '2022'
---
![é…å›¾æºè‡ª Freepik](https://upload-images.jianshu.io/upload_images/5128488-8ca6d14242f855ee.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç¤ºä¾‹ ğŸ‘‰ **[toFrankie/yarn-workspaces-demo](https://github.com/toFrankie/yarn-workspaces-demo)**


## Usage

æŸ¥çœ‹ workspaces

```shell
# æŸ¥çœ‹ Workspace ä¿¡æ¯
$ yarn workspaces info
```

æ‰§è¡Œè„šæœ¬å‘½ä»¤

```shell
# åœ¨æŸä¸ª workspace ä¸­æ‰§è¡Œè„šæœ¬å‘½ä»¤
$ yarn workspace <workspace-name> <command>

# åœ¨æ‰€æœ‰ workspace ä¸­æ‰§è¡Œè„šæœ¬å‘½ä»¤
$ yarn workspaces run <command>
```

æ·»åŠ ä¾èµ–

```shell
# åœ¨æŸä¸ª workspace ä¸­æ·»åŠ ä¾èµ–
$ yarn workspace <workspace-name> add <package>
```

\*ä»¥ä¸Šä¸º Yarn 1.x å‘½ä»¤ï¼Œè€Œ 2.x éƒ¨åˆ†æœ‰è°ƒæ•´ï¼Œè¯¦çœ‹[è¿™é‡Œ](https://yarnpkg.com/features/workspaces)ã€‚

## è½¯é“¾æ¥æŸ¥æ‰¾

å‡è®¾æˆ‘ä»¬é¡¹ç›®çš„ Workspaces å¦‚ä¸‹ï¼Œ

```json
{
  "@workspace/project-1": {
    "location": "packages/project-1",
    "workspaceDependencies": ["@workspace/common"],
    "mismatchedWorkspaceDependencies": []
  },
  "@workspace/project-2": {
    "location": "packages/project-2",
    "workspaceDependencies": [],
    "mismatchedWorkspaceDependencies": []
  },
  "@workspace/common": {
    "location": "packages/common",
    "workspaceDependencies": [],
    "mismatchedWorkspaceDependencies": []
  }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­ `@workspace/project-1` ä¾èµ–äº† `@workspace/common`ï¼Œæ‰€ä»¥ `workspaceDependencies` ä¸ä¸ºç©ºã€‚åä¹‹ï¼Œæ²¡æœ‰å¼•ç”¨çš„è¯å°±ä¸ºç©ºæ•°ç»„ã€‚

å‡è®¾ï¼Œæˆ‘ä»¬åœ¨ `project-1` ä¸­å¼•ç”¨äº† `common` ä¸­çš„å¯¼å‡ºæ¨¡å—ï¼Œå¦‚ä¸‹ï¼š

```js
// packages/common/index.js
export const config = { name: 'Frankie', age: 20 }
```

```js
// packages/project-1/index.js
import { config } from '@workspace/common'
console.log(config)
```

å½“ `project-1` ä¸­æŸ¥æ‰¾ `@workspace/common` æ—¶ï¼š

1. å…ˆæŸ¥æ‰¾ `project-1` æ˜¯å¦å­˜åœ¨å¯¹åº”ç‰ˆæœ¬çš„ `@workspace/common`ï¼Œè‹¥æ‰¾ä¸åˆ°ç»§ç»­å¾€ä¸‹ï¼›
2. æŸ¥æ‰¾ workspace-root æ˜¯å¦å­˜åœ¨å¯¹åº”ç‰ˆæœ¬çš„ `@workspace/common`ï¼Œè‹¥æ‰¾ä¸åˆ°ç»§ç»­å¾€ä¸‹ï¼›
3. æŸ¥æ‰¾ NPM å¹³å°æ˜¯å¦å­˜åœ¨å¯¹åº”ç‰ˆæœ¬çš„ `@workspace/common`ï¼Œè‹¥æ‰¾åˆ°ä¼šæ‹‰å–ä¸‹æ¥ï¼Œè‹¥æ‰¾ä¸åˆ°ç»§ç»­å¾€ä¸‹ï¼›
4. æŠ›å‡ºé”™è¯¯ Not Foundã€‚

## References

- [Yarn Workspace 1.x](https://classic.yarnpkg.com/lang/en/docs/workspaces/)
- [Yarn Workspace 2.x](https://yarnpkg.com/features/workspaces)
- [Monorepo æœ€ä½³å®è·µä¹‹ Yarn Workspaces](https://juejin.cn/post/7011024137707585544)
