---
title: å†è§ nvmï¼Œæ”¹ç”¨ fnm äº†
number: '#96'
link: 'https://github.com/toFrankie/blog/issues/96'
created_at: '2023-02-25 20:30:01'
updated_at: '2023-11-27 14:09:37'
labels:
  - Mac
  - Node.js
  - '2022'
---
![é…å›¾æºè‡ª Freepik](https://upload-images.jianshu.io/upload_images/5128488-2ca3cf66e3e7e498.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


ç¤¾åŒºä¸Šç”¨äºç®¡ç† Node ç‰ˆæœ¬çš„å·¥å…·å¾ˆå¤šï¼Œè¾ƒä¸ºæµè¡Œçš„æœ‰ï¼š

> * éè·¨å¹³å°ï¼š[nvm](https://github.com/nvm-sh/nvm)ã€[n](https://github.com/tj/n)
> * è·¨å¹³å°ï¼š[nvs](https://github.com/jasongin/nvs)ã€[fnm](https://github.com/Schniz/fnm)

**ä¸ªäººå¼ƒç”¨ nvm ä¸æ˜¯å› ä¸ºå®ƒä¸è·¨å¹³å°ï¼Œè€Œæ˜¯å¯åŠ¨ Shell è¿›ç¨‹å¤ªè€—æ—¶äº†...** åŠ ä¹‹å®ƒæœ¬èº«é—®é¢˜æŒºå¤šçš„ï¼Œè¯¦è§ï¼š[Important Notes](https://github.com/nvm-sh/nvm#important-notes)ã€‚

å¯¹æˆ‘æœ€ç›´æ¥çš„å½±å“æ˜¯ï¼šæ­¤å‰é‚£ä¸ª 8G è¿å­˜çš„ MacBook Pro æ‰“å¼€ VS Code çš„æ—¶å€™ï¼Œæ€»ä¼šå› ä¸º Shell è§£æå¤ªä¹…å¯¼è‡´ VS Code ç»ˆæ­¢è§£æï¼Œæœ€ç»ˆé€ æˆäº†æŸäº› Pluginsï¼ˆæ¯”å¦‚ Mercurial ç›¸å…³æ’ä»¶ï¼‰æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚æ­¤å‰åæ§½è¿‡äº†ï¼Œå¯ç§»æ­¥æ–‡ç« ï¼š[è§£å†³ Unable to resolve your shell environment in a reasonable time](https://github.com/toFrankie/blog/issues/47)ã€‚


## ä¸€ã€fnm å®‰è£…ä¸ä½¿ç”¨

[fnm](https://github.com/Schniz/fnm)ï¼ˆFast Node Managerï¼‰åŸºäº Rust å¼€å‘ï¼Œæ˜¯ä¸æ˜¯è¿˜æ²¡ç”¨å°±æ„Ÿè§‰åˆ°å®ƒçš„å¿«äº†ï¼Œå“ˆå“ˆ~
åŒæ—¶ï¼Œå®ƒæ˜¯è·¨å¹³å°çš„ï¼Œæ”¯æŒ macOSã€Linuxã€Windowsã€‚

> ğŸš€ Fast and simple Node.js version manager, built in Rust.

**1. å®‰è£… fnmï¼ˆä»¥ macOS ä¸ºä¾‹ï¼‰**

```shell
$ brew install fnm
```

**2. é…ç½® fnm æ‰€éœ€çš„ç¯å¢ƒå˜é‡åˆ° bash æˆ– zsh é…ç½®æ–‡ä»¶ä¸­ï¼Œä»¥ zsh ä¸ºä¾‹ï¼š**

```shell
$ fnm env --use-on-cd >> ~/.zshrc
```
äº¦å¯æ‰§è¡Œ `fnm env --use-on-cd`ï¼Œå°†è¾“å‡ºå†…å®¹æ‰‹åŠ¨æ·»åŠ è‡³ `.bash_profile` æˆ– `.zshrc` é‡Œã€‚

**3. ç”¨ fnm å®‰è£… Node**

```shell
# å®‰è£… LTS ç‰ˆæœ¬
$ fnm install --lts

# å®‰è£…æŒ‡å®šå¤§ç‰ˆæœ¬çš„æœ€æ–°ç‰ˆæœ¬
$ fnm install 18

# å®‰è£…æŒ‡å®šç‰ˆæœ¬
$ fnm install 18.21.1
```

ç›¸ååœ°ï¼Œå¯é€šè¿‡ `fnm uninstall <version>` æˆ– `fnm uninstall <alias-name>` æ¥åˆ é™¤æŒ‡å®šç‰ˆæœ¬ï¼Œåè€…ä¼šåŒæ—¶ç§»é™¤åˆ«åã€‚

**4. é€šè¿‡ fnm æ¥æŒ‡å®š Node ç‰ˆæœ¬**

```shell
# ä½¿ç”¨ç³»ç»Ÿç‰ˆæœ¬
$ fnm use system

# ä½¿ç”¨ fnm æ‰€å®‰è£…ï¼Œä¸”ç‰ˆæœ¬å·ä¸º 18.21.1 çš„ Node ç¨‹åº
$ fnm use 18.21.1

# ä½¿ç”¨ fnm æ‰€å®‰è£…ï¼Œä¸”ä¸»ç‰ˆæœ¬å·ä¸º 18 çš„æœ€æ–°ç‰ˆæœ¬çš„ Node ç¨‹åº
$ fnm use 18
```
åªè¦ç”¨ `fnm use <version>` æŒ‡å®šåï¼Œæ¯æ¬¡å¯åŠ¨ Shell å°†ä¼šé»˜è®¤ä½¿ç”¨å¯¹åº”çš„ Node ç‰ˆæœ¬ã€‚

**5. è®¾ç½®åˆ«å**

```shell
# å½¢å¼å¦‚ï¼šfnm alias <æŒ‡å®šç‰ˆæœ¬å·> <åˆ«å>
$ fnm alias 18.21.1 v18

# è®¾ç½®åˆ«ååï¼Œå¯ä»¥ç®€åŒ–æŒ‡ä»¤ä¸ºï¼š
$ fnm use v18
```

**å…¶å®ä»¥ä¸Šç¤ºä¾‹çš„åˆ«åæ„ä¹‰ä¸å¤§ï¼Œä»…ç”¨äºä¸¾ä¾‹è€Œå·²**ã€‚åŸå› æ˜¯ï¼šåœ¨ã€Œä¸è®¾ç½®åˆ«åã€çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ `fnm use 18`ï¼Œä¹Ÿèƒ½åˆ‡æ¢è‡³ `18.21.1`ã€‚ä½¿ç”¨ `fnm use <major>` ä¼šåˆ‡æ¢è‡³å¯¹åº”ä¸»ç‰ˆæœ¬å·å¯¹åº”çš„æœ€æ–°ç‰ˆæœ¬ã€‚

> å‡è®¾æˆ‘ä»¬å®‰è£…äº† `18.20.0` å’Œ `18.21.1` ä¸¤ä¸ªä¸»ç‰ˆæœ¬å·ç›¸åŒçš„ Node ç¨‹åºï¼Œä½¿ç”¨ `fnm use 18` åªä¼šåˆ‡æ¢è‡³ `18.21.1`ï¼ˆå³æœ€æ–°çš„ç‰ˆæœ¬ï¼‰ï¼Œå°½ç®¡é€šè¿‡ `fnm alias 18.20.0 18` å°† `18.20.0` çš„åˆ«åè®¾ä¸º `18`ï¼Œè¿™æ ·è®¾ç½®åˆ«åæ˜¯æ— æ„ä¹‰çš„ã€‚
> æ­¤æ—¶å¯èƒ½éœ€è¦ç”¨ `fnm use 18.20` æˆ– `fnm use 18.20.0` æ¥åˆ‡æ¢æŒ‡å®šç‰ˆæœ¬äº†ï¼Œæˆ–è€…å…¶ä»–éçº¯æ•°å­—çš„åˆ«åäº†ã€‚

è¾ƒæœ‰æ„ä¹‰çš„ç‰¹æ®Šåˆ«å `system` å’Œ `default`ï¼š

* å‰è€…æ˜¯ä»¥ `.pkg` ç­‰å½¢å¼ï¼ˆæ¯”å¦‚å®˜ç½‘ä¸‹è½½çš„å®‰è£…åŒ…ï¼‰æ‰€å®‰è£…çš„ Node åº”ç”¨ç¨‹åºï¼Œç§°ä¸ºç³»ç»Ÿç‰ˆæœ¬ã€‚
* åè€…æ˜¯ç”¨äºæŒ‡å®š `fnm` çš„ä¸€ä¸ªé»˜è®¤ç‰ˆæœ¬ï¼Œä½œä¸ºä¸ `18` æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯å…¶è¯­ä¹‰è¡¨ç¤ºé»˜è®¤ç½¢äº†ã€‚

```shell
# æŒ‡å®šé»˜è®¤ç‰ˆæœ¬
$ fnm default 18.21.1

# ç›¸å½“äº
$ fnm alias 18.21.1 default
```

ç›¸ååœ°ï¼Œå¯é€šè¿‡ `fnm unalias <alias-name>` æ¥å–æ¶ˆåˆ«åã€‚

**6. é¡¹ç›®ä¸­æŒ‡å®šç‰¹å®šç‰ˆæœ¬**

å¯ä»¥é€šè¿‡åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ  `.node-version` æˆ– `.nvmrc` æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­æŒ‡å®šç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼š

```shell
$ echo '18' > .node-version
```

å‰ææ˜¯ï¼Œé…ç½® fnm ç¯å¢ƒç”¨çš„æ˜¯ `fnm env --use-on-cd` å‘½ä»¤ï¼Œè€Œä¸æ˜¯ `fnm env`ã€‚åè€…æ²¡æœ‰æ·»åŠ  Hookï¼Œå› æ­¤ä¸ä¼šæ˜¯æ£€æŸ¥å¯¹åº”é…ç½®æ–‡ä»¶ã€‚æœ‰å…´è¶£çš„å¯ä»¥å¯¹æ¯”ä¸¤æ¡å‘½ä»¤çš„å·®åˆ«å°±æ˜ç™½äº†ã€‚

ç”±äºå›¢é˜Ÿæˆå‘˜æ‰€å®‰è£…çš„ Nodeï¼Œå…¶æ¬¡ç‰ˆæœ¬æˆ–è¡¥ä¸ç‰ˆæœ¬å·å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤ï¼Œå¤šæ•°æƒ…å†µä¸‹æŒ‡å®šä¸»ç‰ˆæœ¬å·å³å¯ï¼Œæ— éœ€æŒ‡å®šåˆ° `18.21.1` ç­‰æ›´å…·ä½“çš„ç‰ˆæœ¬å·ï¼ˆç‰¹æ®Šåœºæ™¯é™¤å¤–ï¼‰ã€‚

**7. å¸è½½ fnm**

è‹¥æ˜¯é€šè¿‡ `brew` å®‰è£…çš„ `fnm`ï¼Œåˆ™ï¼š

```shell
$ brew uninstall fnm
```

æ¥ç€ï¼Œå†ç§»é™¤ `~/.fnm` ç›®å½•ã€‚

```shell
$ rm -rf ~/.fnm
```

æœ€åï¼Œç§»é™¤ `bash` æˆ– `zsh` çš„é…ç½®æ–‡ä»¶ä¸­ä¸ `fnm` ç›¸å…³çš„é…ç½®ã€‚æ¯”å¦‚ï¼š

```shell
export PATH="/Users/frankie/Library/Caches/fnm_multishells/49559_1670052262156/bin":$PATH
export FNM_VERSION_FILE_STRATEGY="local"
export FNM_DIR="/Users/frankie/Library/Application Support/fnm"
export FNM_NODE_DIST_MIRROR="https://nodejs.org/dist"
export FNM_MULTISHELL_PATH="/Users/frankie/Library/Caches/fnm_multishells/49559_1670052262156"
export FNM_ARCH="x64"
export FNM_LOGLEVEL="info"
autoload -U add-zsh-hook
_fnm_autoload_hook() {
  if [[ -f .node-version || -f .nvmrc ]]; then
    fnm use --silent-if-unchanged
  fi
}

add-zsh-hook chpwd _fnm_autoload_hook &&
  _fnm_autoload_hook

rehash
```

## äºŒã€ç§»é™¤ nvm

åœ¨ç§»é™¤ä¹‹å‰ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹ä½¿ç”¨ `nvm` æ‰€å®‰è£…çš„å…¨å±€åŒ…ï¼Œç„¶ååˆ‡æ¢åˆ° `fnm` å®‰è£…ä¸€ä¸‹ï¼ˆæœ‰éœ€è¦çš„è¯ï¼‰ï¼š

```shell
$ nvm use 16
Now using node v16.14.0 (npm v8.3.1)

$ npm list -g
/Users/frankie/.nvm/versions/node/v16.14.0/lib
â”œâ”€â”€ corepack@0.10.0
â”œâ”€â”€ npm@8.3.1
â”œâ”€â”€ pnpm@7.5.0
â”œâ”€â”€ simple-shell@
â””â”€â”€ zx@7.0.7
```

ç§»é™¤ `nvm` çš„å®‰è£…ç›®å½•ï¼Œé€šå¸¸æ˜¯ `~/.nvm`ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š

```shell
$ rm -rf "$NVM_DIR"
```

ç§»é™¤ `bash` æˆ– `zsh` çš„é…ç½®æ–‡ä»¶ä¸­ä¸ `nvm` ç›¸å…³çš„é…ç½®ã€‚æ¯”å¦‚ï¼š

```shell
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" --no-use          # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion" # This loads nvm bash_completion
```

å…¶ä»–ç³»ç»Ÿå¯çœ‹ [Uninstalling / Removal](https://github.com/nvm-sh/nvm#uninstalling--removal)ã€‚

## å…¶ä»–

ç›¸å…³å†…å®¹æ–‡ç« ï¼š

* [ç”¨é”ˆåŒ–çš„ fnm ç®¡ç† Node.js ç‰ˆæœ¬](https://zhuanlan.zhihu.com/p/587008009)
* [ä½¿ç”¨ nvs ç®¡ç†æœ¬åœ° Node.js ç‰ˆæœ¬](https://zhuanlan.zhihu.com/p/63403762)
* [ä» nvm è¿ç§»åˆ° nvs](https://ukn.me/cong-nvm-qian-yi-dao-nvs.html)

The end.
