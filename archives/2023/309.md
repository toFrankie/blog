---
title: npm install æŒ‡å®šç‰ˆæœ¬
number: '#309'
link: 'https://github.com/toFrankie/blog/issues/309'
created_at: '2023-04-05 12:37:09'
updated_at: '2023-04-26 22:41:48'
labels:
  - Node.js
  - '2023'
---

![é…å›¾æºè‡ª Freepik](https://cdn.jsdelivr.net/gh/toFrankie/blog/images/1680686247374.jpg)

npm å®‰è£…åŒ…çš„æ–¹å¼å¾ˆå¤šå¾ˆå¤šï¼Œæœ¬æ–‡å°±ä»¥ä¸‹å‡ ç§æ–¹å¼ä½œç®€è¦ä»‹ç»ã€‚

```shell
$ npm install <name>
$ npm install <name>@<tag>
$ npm install <name>@<version>
$ npm install <name>@<version range>
```

## npm install \<name>

å®ƒå…¶å®å°±æ˜¯ `npm install <name>@<tag>` ç®€å†™å½¢å¼ã€‚ç”±äº `<tag>` é»˜è®¤ä¸º `latest`ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰ï¼Œå› æ­¤åœ¨ä¸ä½œä»»ä½•é…ç½®çš„æƒ…å†µä¸‹ `npm install <name>` ä¼šæŒ‰ç…§è¯¥åŒ…çš„æœ€æ–°ç‰ˆæœ¬ã€‚

## npm install \<name>@\<tag>

### tag æ˜¯ä»€ä¹ˆï¼Ÿ

åœ¨è½¯ä»¶å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ‰é‡å¤§çš„ç‰ˆæœ¬å˜æ›´ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç»™å®ƒæ‰“ä¸Šä¸€ä¸ªã€Œæ ‡ç­¾ã€ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ›´å‹å¥½ã€æ˜“äºç†è§£çš„ã€Œåˆ«åã€ç½¢äº†ã€‚åƒå¹³å¸¸ä½¿ç”¨ Git åšç‰ˆæœ¬ç®¡ç†æ—¶ï¼Œä¹Ÿä¼šç”¨ `git tag` æ‰“æ ‡ç­¾ã€‚

### æœ‰å“ªäº› tagï¼Ÿ

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`latest` æ ‡ç­¾ç”¨æ¥æ ‡è¯†æŸä¸ªåŒ…çš„æœ€æ–°ç‰ˆæœ¬ã€‚

> é™¤äº† `latest` ä¹‹å¤–ï¼Œæ²¡æœ‰ä»»ä½•æ ‡ç­¾å¯¹ npm æœ¬èº«æœ‰ä»»ä½•ç‰¹æ®Šæ„ä¹‰ã€‚

ä¸€ä¸ªåŒ…å¦‚æœ‰å¤šä¸ªå¼€å‘æµç¨‹å¯ä»¥è‡ªå®šä¹‰ä¸€äº›æœ‰æ„ä¹‰çš„ tagï¼Œæ¯”å¦‚ï¼š`stable`ã€`alpha`ã€`beta`ã€`dev`ã€`canary`ã€`next`ã€‚é™¤äº† `latest` ä¹‹å¤–çš„æ‰€æœ‰ tagï¼Œéƒ½éœ€è¦åœ¨æ‰‹åŠ¨æŒ‡å®šã€‚

### å¦‚ä½•æŸ¥çœ‹ tagï¼Ÿ

é€šè¿‡ [npm-dist-tag](https://docs.npmjs.com/cli/v9/commands/npm-dist-tag) å‘½ä»¤ï¼š

```shell
$ npm dist-tag ls <name>
```

ä¸¾ä¸ªä¾‹å­ï¼š

```shell
$ npm dist-tag ls lodash-es
latest: 4.17.21

$ npm dist-tag ls react
beta: 18.0.0-beta-24dd07bd2-20211208
experimental: 0.0.0-experimental-b14f8da15-20230403
latest: 18.2.0
next: 18.3.0-next-b14f8da15-20230403
rc: 18.0.0-rc.3
```
æˆ–åœ¨ [npmjs.com](https://www.npmjs.com/) ç­‰å¹³å°æŸ¥çœ‹ï¼š

![](https://cdn.jsdelivr.net/gh/toFrankie/blog/images/1680675748538.png)

### å¦‚ä½•æ·»åŠ /ç§»é™¤ tagï¼Ÿ

åœ¨å‘åŒ…æ—¶é€šè¿‡ `--tag` å‚æ•°æŒ‡å®šï¼Œè‹¥æ— æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸º `latest`ã€‚æ¯”å¦‚ï¼š

```shell
$ npm publish --tag <tag>
```

å¯¹äºå·²å‘å¸ƒçš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡ `npm dist-tag add` æˆ– `npm dist-tag rm` æ¥æ·»åŠ /ç§»é™¤ tagã€‚æ¯”å¦‚ï¼š

```shell
$ npm dist-tag add <name>@<version> <tag>
$ npm dist-tag rm <name> <tag>
```


ä¸¾ä¸ªä¾‹å­ï¼š

```shell
# æœªæŒ‡å®šæ—¶ï¼Œé»˜è®¤ä¸º latest
$ npm publish
npm notice 
npm notice ğŸ“¦  @summer/my-pack@0.0.1
npm notice === Tarball Contents === 
npm notice 27B  README.md   
npm notice 232B package.json
npm notice 27B  src/index.js
npm notice === Tarball Details === 
npm notice name:          @summer/my-pack                         
npm notice version:       0.0.1                                   
npm notice filename:      summer-my-pack-0.0.1.tgz                
npm notice package size:  342 B                                   
npm notice unpacked size: 286 B                                   
npm notice shasum:        84c45d5eb997b714cb1348624b71046ed6c987a8
npm notice integrity:     sha512-blbi1Q3A8La3A[...]r6BVjGtYZ8rCw==
npm notice total files:   3                                       
npm notice 
npm notice Publishing to http://localhost:4873/ with tag latest and default access
+ @summer/my-pack@0.0.1

$ npm dist-tag ls @summer/my-pack
latest: 0.0.1

# å‘å¸ƒä¸€ä¸ªåä¸º next çš„ tag
$ npm publish --tag next
npm notice 
npm notice ğŸ“¦  @summer/my-pack@0.0.2
npm notice === Tarball Contents === 
npm notice 27B  README.md   
npm notice 232B package.json
npm notice 27B  src/index.js
npm notice === Tarball Details === 
npm notice name:          @summer/my-pack                         
npm notice version:       0.0.2                                   
npm notice filename:      summer-my-pack-0.0.2.tgz                
npm notice package size:  342 B                                   
npm notice unpacked size: 286 B                                   
npm notice shasum:        e9575fc34aacf2a08bb4f33a768dcf5ba4aab494
npm notice integrity:     sha512-kcHYodhWGbAds[...]TU53bhFy46wUw==
npm notice total files:   3                                       
npm notice 
npm notice Publishing to http://localhost:4873/ with tag next and default access
+ @summer/my-pack@0.0.2

$ npm dist-tag ls @summer/my-pack
latest: 0.0.1
next: 0.0.2

# ç§»é™¤ next tagï¼Œä½†æ³¨æ„ç§»é™¤å latest ä»ä¸º 0.0.1 ç‰ˆæœ¬
$ npm dist-tag rm @summer/my-pack next
-next: @summer/my-pack@0.0.2

$ npm dist-tag ls @summer/my-pack
latest: 0.0.1

# æ‰‹åŠ¨æŒ‡å®š 0.0.2 ç‰ˆæœ¬ä¸º latest tag
$ npm dist-tag add @summer/my-pack@0.0.2 latest
+latest: @summer/my-pack@0.0.2

# æ‰‹åŠ¨æŒ‡å®š 0.0.1 ç‰ˆæœ¬ä¸º legacy tag
$ npm dist-tag add @summer/my-pack@0.0.1 legacy
+legacy: @summer/my-pack@0.0.1

$ npm dist-tag ls @summer/my-pack
latest: 0.0.2
legacy: 0.0.1
```

![](https://cdn.jsdelivr.net/gh/toFrankie/blog/images/1680678651843.png)

### å®‰è£…æŒ‡å®š tag

å‰é¢äº†è§£ tag ä¹‹åï¼Œå®‰è£…å°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚

```shell
$ npm install <name>@<tag>

# ç›¸å½“äº
$ npm install <name> --tag <tag>
```

å¦‚æœ‰ç‰¹æ®Šéœ€è¦ï¼Œå¯é€šè¿‡ `npm config set tag <tag>` å»é…ç½® tagï¼ˆ[è¯¦è§](https://docs.npmjs.com/cli/v9/using-npm/config#tag)ï¼‰ï¼Œåé¢ `npm install` ä¸æŒ‡å®š tag æ—¶ï¼Œé»˜è®¤å–è¯¥é…ç½®å€¼ã€‚

## npm install \<name>@\<version>

å®‰è£…æ—¶æŒ‡å®šç‰ˆæœ¬æˆ–æŒ‡å®šç‰ˆæœ¬èŒƒå›´ï¼š

```shell
$ npm install <name>@<version>
$ npm install <name>@<version range>
```

### å®‰è£…ç¡®åˆ‡ç‰ˆæœ¬

ä¸€æ˜¯å®‰è£…æ—¶æŒ‡å®šç¡®åˆ‡ç‰ˆæœ¬ï¼ŒäºŒæ˜¯é…ç½® `save-exact` ä¸º `true`ï¼ˆ`npm config set save-exact true`ï¼‰ã€‚æ¯”å¦‚ï¼š

```shell
$ npm install react@18.0.0

# ç›¸å½“äºï¼ˆå‡è®¾å½“å‰ react çš„ latest ä¸º 18.0.0ï¼‰
$ npm config set save-exact true
$ npm install react
```

é‚£ä¹ˆå®‰è£…å°±ä¸ä¼šä¸‹è½½ç¬¦åˆ `^x.y.z` æˆ– `~x.y.z` èŒƒå›´çš„ç‰ˆæœ¬äº†ã€‚

### å®‰è£… ^ æˆ– ~ ç‰ˆæœ¬

ä½¿ç”¨ `npm install <name>` å®‰è£…åŒ…æ—¶ï¼Œå®ƒä¼šä»¥ `^x.y.z` å½¢å¼æ·»åŠ åˆ° `package.json` é‡Œé¢ã€‚å› ä¸º npm çš„ `save-prefix` é»˜è®¤é…ç½®å°±æ˜¯ `^`ï¼Œå¯é€šè¿‡ `npm config set save-prefix '~'` æŒ‡å®šä¸º `~`ã€‚äºŒè€…å«ä¹‰ï¼Œå¤§å®¶éƒ½æ‡‚å°±ä¸å†å±•å¼€èµ˜è¿°äº†ã€‚

### å®‰è£…ä¸»è¦ç‰ˆæœ¬çš„æœ€æ–°ç‰ˆæœ¬

```shell
$ npm install <name>@<major-version>
```

æ¯”å¦‚ `npm install react@16` æˆ– `npm install react@16.x` ä¼šå®‰è£… 16.x ä¸­æœ€æ–°çš„ç‰ˆæœ¬ `^16.14.0`ã€‚

æœ€è¿‘ä¹Ÿé‡åˆ°è¿™ç§éœ€æ±‚ï¼šç›®å‰ [ora](https://www.npmjs.com/package/ora) æœ€æ–°ç‰ˆæœ¬æ˜¯ 6.3.0ï¼Œè¯¥ç‰ˆæœ¬ä¸å†æ”¯æŒ CommonJS å½¢å¼å¯¼å…¥ï¼Œå› æ­¤ä½¿ç”¨ `const ora = require('ora')` å°†ä¼šæŠ¥é”™ï¼š

```shell
const ora = require('ora')
            ^

Error [ERR_REQUIRE_ESM]: require() of ES Module /Users/frankie/Web/Temp/demo/node_modules/ora/index.js from /Users/frankie/Web/Temp/demo/src/index.js not supported.
```

å¯å®‰è£… 5.x ç‰ˆæœ¬ä»¥æ”¯æŒ CommonJSï¼ˆ`npm install ora@5`ï¼‰ã€‚

## npm install \<name>@\<version range>

èŒƒå›´å¯é€šè¿‡ä½¿ç”¨ `>`ã€`<`ã€`=`ã€ `-` ç­‰é™å®šç¬¦ç»„åˆã€‚æ¯”å¦‚ï¼š

```shell
# å®‰è£…èŒƒå›´å†…çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆ17.0.1ï¼‰
$ npm install react@">=16.0.0 <17.0.2" 

# å®‰è£…å¤§ç‰ˆæœ¬ä¸º 16 è‡³ 17 çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆ17.0.2ï¼‰
$ npm install react@"16 - 17"
```

## References

- [npm-install](https://docs.npmjs.com/cli/v9/commands/npm-install)
- [npm-dist-tag](https://docs.npmjs.com/cli/v9/commands/npm-dist-tag)
- [npm SemVer Calculator](https://semver.npmjs.com/)
