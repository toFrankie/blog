---
title: ç»†è¯» JS | æ•°æ®ç±»å‹è¯¦è§£
number: '#239'
link: 'https://github.com/toFrankie/blog/issues/239'
created_at: '2023-02-26 19:09:16'
updated_at: '2023-11-27 14:04:38'
labels:
  - å‰ç«¯
  - å°šæœªå®Œç»“...
  - JS/ES
  - '2021'
---
ä»Šå¤©åˆåˆåˆ...åˆæ•´ç†äº†ä¸€ä¸‹ï¼Œé‚£äº› JavaScript é‡Œä¸æ¸…ä¸æ¥šçš„çŸ¥è¯†ç‚¹ã€‚

### ä¸€ã€æ•°æ®ç±»å‹çš„åˆ†ç±»

æˆªæ­¢å‘æ–‡æ—¥æœŸï¼ŒECMAScript æ ‡å‡†çš„æ•°æ®ç±»å‹ä»…æœ‰ 8 ç§ï¼ˆ[ECMAScript Language Types](https://262.ecma-international.org/#sec-ecmascript-language-types)ï¼‰ã€‚å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š

* **åŸå§‹ç±»å‹**ï¼ˆPrimitivesï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿç§°ä½œ**åŸºæœ¬æ•°æ®ç±»å‹**ã€‚
  * Undefined
  * Nullï¼ˆä¸€ç§ç‰¹æ®Šçš„åŸå§‹ç±»å‹ï¼Œ`typeof(instance) === 'object'`ï¼‰
  * Boolean
  * String
  * Symbolï¼ˆ`typeof(instance) === 'symbol'`ï¼‰
  * Number
  * BigIntï¼ˆ`typeof(instance) === 'bigint'`ï¼‰
* **å¼•ç”¨ç±»å‹**ï¼ˆObjectsï¼‰
  * Objectï¼ˆåŒ…æ‹¬ä» Object æ´¾ç”Ÿå‡ºæ¥çš„ç»“æ„ç±»å‹ï¼Œå¦‚ Objectã€Arrayã€Mapã€Setã€Date ç­‰ï¼‰


> å…³äºä½¿ç”¨ `typeof` åˆ¤æ–­ä»¥ä¸Šæ•°æ®ç±»å‹çš„è¯é¢˜ï¼Œè€ç”Ÿå¸¸è°ˆäº†ã€‚ä¾‹å¦‚ï¼Œä¸ºä»€ä¹ˆ `typeof null === 'object'`ã€`typeof(() => {}) === 'function'` å‘¢ï¼Ÿè¿™é‡Œä¸å±•å¼€èµ˜è¿°äº†ï¼Œè¯·ç§»æ­¥ï¼š[JavaScript çš„è¿·æƒ‘è¡Œä¸ºå¤§èµ](https://www.jianshu.com/p/99be3be66e13)ã€‚

åŸå§‹ç±»å‹çš„æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œåªæœ‰ä¸¤è€…çš„å€¼ç›¸ç­‰ï¼Œé‚£ä¹ˆå®ƒä»¬è¢«è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ï¼Œå¦åˆ™ä¸ç›¸ç­‰ã€‚è€Œå¼•ç”¨ç±»å‹æ¯”è¾ƒçš„æ˜¯åœ°å€ï¼Œå½“ä¸¤è€…çš„æ ‡è¯†ç¬¦åŒæ—¶æŒ‡å‘å†…å­˜çš„åŒä¸€ä¸ªåœ°å€ï¼Œåˆ™è¢«è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ï¼Œå¦åˆ™ä¸ç›¸ç­‰ã€‚

```js
console.log({} == {}) // false
console.log([] == []) // false
```

### äºŒã€åŸå§‹ç±»å‹ä¸åŸå§‹å€¼

æ‰€æœ‰åŸºæœ¬ç±»å‹çš„å€¼ï¼ˆå³åŸå§‹å€¼ï¼ŒPrimitive Valuesï¼‰éƒ½æ˜¯**ä¸å¯æ”¹å˜**ï¼ˆimmutableï¼‰çš„ï¼Œè€Œä¸”**ä¸å«ä»»ä½•å±æ€§å’Œæ–¹æ³•**çš„ã€‚

**åˆ°è¿™é‡Œå¯èƒ½ä¼šæœ‰å°ä¼™ä¼´æ‰“é—®å·äº†ï¼Ÿï¼Ÿï¼Ÿ**

Q1ï¼šåŸå§‹ç±»å‹ä¸åŸå§‹å€¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
> åŸå§‹ç±»å‹çš„å€¼ç§°ä¸ºåŸå§‹å€¼ã€‚ä¾‹å¦‚åŸå§‹ç±»å‹ Boolean æœ‰ä¸¤ä¸ªï¼ˆåŸå§‹ï¼‰å€¼ `true` å’Œ `false`ã€‚åŒæ ·çš„åŸå§‹ç±»å‹ Undefinedï¼ˆNullï¼‰ï¼Œåªæœ‰ä¸€ä¸ªåŸå§‹å€¼ `undefined`ï¼ˆ`null`ï¼‰ã€‚å…¶ä»–çš„å°±æœ‰å¾ˆå¤šä¸ªäº†...

Q2ï¼šåŸå§‹å€¼ä¸å¯æ”¹å˜ï¼Ÿè¿™æ ·ä¸æ˜¯æ”¹å˜äº†å—ï¼Ÿ

```js
var foo = true
foo = false
console.log(foo) // false
```

> å…¶å®ä¸ç„¶ï¼Œä»¥ä¸Šç¤ºä¾‹æ˜¯åŸå§‹ç±»å‹å’Œä¸€ä¸ªèµ‹å€¼ä¸ºåŸå§‹ç±»å‹çš„å˜é‡çš„åŒºåˆ«ã€‚å˜é‡ä¼šè¢«èµ‹äºˆä¸€ä¸ªæ–°å€¼ï¼Œè€ŒåŸå€¼ä¸èƒ½åƒæ•°ç»„ã€å¯¹è±¡ä»¥åŠå‡½æ•°é‚£æ ·è¢«æ”¹å˜ã€‚

åŸºæœ¬ç±»å‹å€¼å¯ä»¥è¢«æ›¿æ¢ï¼Œä½†ä¸èƒ½è¢«æ”¹å˜ã€‚

```js
// ä½¿ç”¨å­—ç¬¦ä¸²æ–¹æ³•ä¸ä¼šæ”¹å˜ä¸€ä¸ªå­—ç¬¦ä¸²
var foo = 'foo'
foo.toUpperCase()
console.log(foo) // "foo"

// èµ‹å€¼è¡Œä¸ºå¯ä»¥ç»™åŸºæœ¬ç±»å‹ä¸€ä¸ªæ–°å€¼ï¼Œè€Œä¸æ˜¯æ”¹å˜å®ƒ
foo = foo.toUpperCase() // "FOO"
```

å†æœ‰ç¤ºä¾‹ï¼š

```js
var num = 1

function add(num) {
  num += 1
  console.log(num)
}

add(num) // 2
console.log(num) // 1

// ************************** åä¸½çš„åˆ†å‰²çº¿ **************************

// å¦‚æœæ²¡æœ‰çœ‹ä¸Šé¢çš„ä¸€äº›æ¦‚å¿µï¼Œå•çº¯åœ°çœ‹ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ç›¸ä¿¡ç™¾åˆ†ç™¾éƒ½èƒ½å¾—åˆ°æ­£ç¡®ç­”æ¡ˆã€‚
// ä½†çœ‹å®Œä¸Šé¢ä¸€äº›çš„æ¦‚å¿µä¹‹åï¼Œå†ç»“åˆä¾‹å­ï¼Œä¸çŸ¥é“ä¼šä¸ä¼šæœ‰äººå¯¹ â€œåŸå§‹ç±»å‹çš„å€¼ä¸å¯æ”¹å˜â€ è¿™å¥è¯äº§ç”Ÿæ€€ç–‘ï¼Ÿ
// å¦‚æœæœ‰æ€€ç–‘å°±ç»§ç»­å¾€ä¸‹çœ‹ ğŸ‘‡ğŸ‘‡ğŸ‘‡ï¼Œå¦åˆ™å¯ç›´æ¥è·³åˆ° Q3 äº†ã€‚

// ************************** åä¸½çš„åˆ†å‰²çº¿ **************************

// JS è¿è¡Œçš„ä¸‰ä¸ªæ­¥éª¤ï¼šè¯æ³•åˆ†æã€é¢„ç¼–è¯‘ã€è§£ææ‰§è¡Œã€‚
// å…¶ä¸­é¢„ç¼–è¯‘ï¼Œä¸ä»…ä»…å‘ç”Ÿåœ¨ script ä»£ç å—æ‰§è¡Œä¹‹å‰ï¼Œè¿˜å‘ç”Ÿåœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰ã€‚
// 
// å‡½æ•°é¢„ç¼–è¯‘çš„è¿‡ç¨‹å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š
// 1. é¦–å…ˆæŸ¥æ‰¾å½¢å‚å’Œå˜é‡å£°æ˜ï¼ˆæ­¤æ—¶å¹¶èµ‹äºˆå€¼ undefinedï¼‰
// 2. æ¥ç€å°†å®å‚èµ‹å€¼ç»™å½¢å‚
// 3. æ¥ç€æŸ¥æ‰¾å‡½æ•°ä½“å†…çš„å‡½æ•°å£°æ˜ï¼ˆèµ‹äºˆå‡½æ•°æœ¬èº«ï¼‰ã€‚
//
// å‡½æ•° add åœ¨å®å‚èµ‹å€¼ç»™å½¢å‚çš„è¿‡ç¨‹ï¼Œä¼šå°†ä¼ é€’è¿›æ¥çš„å‚æ•°ï¼ˆåŸºæœ¬ç±»å‹çš„å€¼ï¼‰å¤åˆ¶ä¸€ä»½ï¼Œ
// åˆ›å»ºä¸€ä¸ªæœ¬åœ°å‰¯æœ¬ï¼Œè¯¥å‰¯æœ¬åªå­˜åœ¨äºè¯¥å‡½æ•°çš„ä½œç”¨åŸŸä¸­ã€‚ï¼ˆåŸæœ¬çš„å€¼ä¸å‰¯æœ¬æ˜¯å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°çš„ï¼‰
```

Q3ï¼šåŸå§‹å€¼æ²¡æœ‰ä»»ä½•å±æ€§å’Œæ–¹æ³•ï¼Ÿé‚£è¿™ä¸ªæ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ

```js
var foo = 'foo'
console.log(foo.length) // 3
console.log(foo.toUpperCase()) // "FOO"

// è¯•å›¾æ”¹å˜ length å±æ€§
foo.length = 4
console.log(foo.length) // 3
```

> å…¶å®è¿™æ˜¯ JavaScript åŒ…è£…ç±»çš„å†…å®¹äº†ã€‚

åœ¨ JavaScript ä¸­é™¤äº† `null` å’Œ `undefined` ä¹‹å¤–ï¼Œæ‰€æœ‰çš„åŸºæœ¬ç±»å‹éƒ½æœ‰å…¶å¯¹åº”çš„åŒ…è£…å¯¹è±¡ï¼ˆWrapper Objectï¼‰ã€‚å› æ­¤ï¼Œè®¿é—® `null` æˆ– `undefined` çš„ä»»ä½•å±æ€§å’Œæ–¹æ³•éƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚

* `String`Â ä¸ºå­—ç¬¦ä¸²åŸºæœ¬ç±»å‹ã€‚
* `Number` ä¸ºæ•°å€¼åŸºæœ¬ç±»å‹ã€‚
* `BigInt` ä¸ºå¤§æ•´æ•°åŸºæœ¬ç±»å‹ã€‚
* `Boolean` ä¸ºå¸ƒå°”åŸºæœ¬ç±»å‹ã€‚
* `Symbol` ä¸ºå­—é¢é‡åŸºæœ¬ç±»å‹ã€‚

è¿™äº›åŒ…è£…å¯¹è±¡çš„ `valueOf `æ–¹æ³•è¿”å›å…¶å¯¹åº”çš„åŸå§‹å€¼ã€‚

> å†æ¬¡æ˜ç¡®ä¸€ç‚¹ï¼ŒåŸå§‹å€¼æ˜¯æ²¡æœ‰ä»»ä½•å±æ€§å’Œæ–¹æ³•çš„ã€‚

ä¸æ˜¯è¯´å¥½çš„ï¼ŒåŸå§‹å€¼ä¸å«ä»»ä½•çš„å±æ€§å’Œæ–¹æ³•å—ï¼Ÿé‚£ `foo.length` å’Œ `foo.toUpperCase()` æ˜¯å’‹å›äº‹å•Šï¼Ÿï¼Ÿï¼Ÿ

å…¶å®å®ƒå†…éƒ¨æ˜¯è¿™æ ·å®ç°çš„ï¼š**å½“å­—ç¬¦ä¸²å­—é¢é‡è°ƒç”¨ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡æ‰æœ‰çš„æ–¹æ³•æˆ–å±æ€§æ—¶ï¼ŒJavaScript ä¼šè‡ªåŠ¨å°†åŸºæœ¬å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å¯¹è±¡å¹¶ä¸”è°ƒç”¨ç›¸åº”çš„æ–¹æ³•æˆ–å±æ€§ã€‚**ï¼ˆBoolean å’Œ Number ä¹ŸåŒæ ·å¦‚æ­¤ï¼‰ã€‚

æˆ‘ä»¬å°è¯•åœ¨æ§åˆ¶å°ä¸Šæ‰“å°ä¸€ä¸‹ `new String('foo')`ï¼Œå¯ä»¥çœ‹åˆ°è¯¥å®ä¾‹å¯¹è±¡æœ‰ä¸€ä¸ª `length` å±æ€§ï¼Œå…¶å€¼ä¸º `3`ï¼Œå®ä¾‹å¯¹è±¡æœ¬èº«æ²¡æœ‰ `toUpperCase()` æ–¹æ³•ï¼Œæ‰€ä»¥æ¥ç€å¾€åŸå‹ä¸ŠæŸ¥æ‰¾ï¼Œæœç„¶æ‰¾åˆ°äº†ã€‚ï¼ˆç”±äºåŸå‹ä¸Šæ–¹æ³•å¤ªå¤šï¼Œæˆªå›¾é‡Œæ²¡æœ‰å±•å¼€ï¼Œå¦åˆ™å½±å“æ–‡ç« ç¯‡å¹…ï¼‰

![](https://upload-images.jianshu.io/upload_images/5128488-7e31081bc5ea336c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


å› æ­¤

```js
var foo = 'foo'
console.log(foo.length) // 3
console.log(foo.toUpperCase()) // "FOO"

// ç›¸å½“äº
var foo = 'foo'
console.log(new String(foo).length) // 3
console.log(new String(foo).toUpperCase()) // "FOO"
```

å¯ä¸‹é¢ä¸ºä»€ä¹ˆ `length` è¿˜æ˜¯ `3` å‘¢ï¼Ÿ

```js
foo.length = 4
console.log(foo.length) // 3

// æ€æ ·ç†è§£å‘¢ï¼Ÿ
//
//
// æ‰§è¡Œç¬¬ä¸€è¡Œä»£ç 
// foo.length = 4 å¯ä»¥æ‹†åˆ†æˆä¸¤éƒ¨åˆ†å»ç†è§£ï¼š
var temp = new String(foo) // åœ¨å†…å­˜ä¸­åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼Œåªæ˜¯æ²¡æœ‰ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰æŒ‡å‘å®ƒè€Œå·²ï¼ˆä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘è¿™é‡Œå‡è£…æœ‰ä¸€ä¸ª temp å˜é‡æŒ‡å‘å®ƒï¼‰
temp.length = 4 // ä¿®æ”¹åŒ…è£…å¯¹è±¡çš„ length å±æ€§ï¼Œå…¶å®æ˜¯ä¿®æ”¹æˆåŠŸçš„
// ç”±äºè¯¥å¯¹è±¡å¹¶æ²¡æœ‰è¢«å¼•ç”¨ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œä¸‹ä¸€å¥ä»£ç ä¹‹å‰å°±è¢«å›æ”¶é”€æ¯äº†
//
//
// 2. æ‰§è¡Œç¬¬äºŒè¡Œä»£ç 
// console.log(foo.length) ç›¸å½“äº
console.log(new String(foo).length) // foo è¿˜æ˜¯ "foo"ï¼Œè‡ªç„¶ç»“æœå°±æ˜¯ 3 äº†ã€‚
```

### ä¸‰ã€å¯¹è±¡

åœ¨ JavaScript ä¸­ï¼Œé™¤äº†ä»¥ä¸Šçš„åŸå§‹å€¼ï¼Œå…¶ä½™éƒ½å±äºå¯¹è±¡ã€‚

ä¸åŸå§‹ç±»å‹ä¸åŒçš„æ˜¯ï¼Œå¯¹è±¡æ˜¯å¯å˜ï¼ˆmutableï¼‰çš„ã€‚


##### 1. å¯¹è±¡çš„åˆ†ç±»

æˆ‘ä»¬å¯ä»¥å°†å¯¹è±¡åˆ’åˆ†ä¸º**æ™®é€šå¯¹è±¡**ï¼ˆordinary objectï¼‰å’Œ**å‡½æ•°å¯¹è±¡**ï¼ˆfunction objectï¼‰ã€‚

é‚£æ€æ ·åŒºåˆ†å‘¢ï¼Ÿæˆ‘ä»¬å…ˆå®šä¹‰ä¸€äº› `Function` å®ä¾‹å’Œ `Object` å®ä¾‹ï¼š

```js
// Function å®ä¾‹
function fn1() {}
var fn2 = function() {}
var fn3 = new Function('console.log("Hi, everyone")') // ä¸€èˆ¬ä¸ä½¿ç”¨ Function æ„é€ å™¨å»ç”Ÿæˆ Function å¯¹è±¡ï¼Œç›¸æ¯”å‡½æ•°å£°æ˜æˆ–è€…å‡½æ•°è¡¨è¾¾å¼ï¼Œå®ƒè¡¨ç°æ›´ä¸ºä½æ•ˆã€‚

// Object å®ä¾‹
var obj1 = {}
var obj2 = new Object()
var obj3 = new fn1()
```

æˆ‘ä»¬æ¥æ‰“å°ä¸€ä¸‹ç»“æœï¼š

```js
typeof Object     // "function"
typeof Function   // "function"

typeof fn1        // "function"
typeof fn2        // "function"
typeof fn3        // "function"

typeof obj1       // "object"
typeof obj2       // "object"
typeof obj3       // "object"
```

`Object` å’Œ `Function` æœ¬èº«å°±æ˜¯ JavaScript ä¸­è‡ªå¸¦çš„å‡½æ•°å¯¹è±¡ã€‚å…¶ä¸­ `obj1`ã€`obj2`ã€`obj3` ä¸ºæ™®é€šå¯¹è±¡ï¼ˆå‡ä¸º `Object` çš„å®ä¾‹ï¼‰ï¼Œè€Œ `fn1`ã€`fn2`ã€`fn3` ä¸ºå‡½æ•°å¯¹è±¡ï¼ˆå‡æ˜¯ `Function` çš„å®ä¾‹ï¼‰ã€‚

è®°ä½ä»¥ä¸‹è¿™å¥è¯ï¼š

> æ‰€æœ‰ `Function` çš„å®ä¾‹éƒ½æ˜¯**å‡½æ•°å¯¹è±¡**ï¼Œè€Œå…¶ä»–çš„éƒ½æ˜¯**æ™®é€šå¯¹è±¡**ã€‚

##### 2. å¯¹è±¡çš„åŸå‹

æ¥ç€ï¼Œå¼•å…¥ä¸¤ä¸ªå¾ˆå®¹æ˜“è®©äººæŠ“ç‹‚ã€æ··æ·†çš„ä¸¤å…„å¼Ÿ `prototype` ï¼ˆåŸå‹å¯¹è±¡ï¼‰å’Œ `__proto__`ï¼ˆåŸå‹ï¼‰ã€‚è¿™ä¿©å…„å¼Ÿçš„ä¸»è¦æ˜¯ä¸ºäº†æ„é€ **åŸå‹é“¾**è€Œå­˜åœ¨çš„ã€‚

| å¯¹è±¡ç±»å‹ | prototype | \_\_proto\_\_ |
|-|-|-|
| æ™®é€šå¯¹è±¡ | âŒ | âœ… |
| å‡½æ•°å¯¹è±¡ | âœ… | âœ… |

å› æ­¤æœ‰ä»¥ä¸‹ç»“è®ºï¼š

> æ‰€æœ‰å¯¹è±¡éƒ½æœ‰ `__proto__` å±æ€§ï¼Œè€Œåªæœ‰å‡½æ•°å¯¹è±¡æ‰å…·æœ‰ `prototype` å±æ€§ã€‚


å†ä¸Šå‡ ä¸ªèœï¼Œè¯·æ…¢æ…¢å“å°ï¼š

```js
// æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª constructor å±æ€§ï¼Œè¯¥å±æ€§æŒ‡å‘å®ä¾‹å¯¹è±¡çš„æ„é€ å‡½æ•°
Object.prototype.constructor === Object // true
Function.prototype.constructor === Function // true


// ï¼ˆå…¨å±€å¯¹è±¡ï¼‰Object æ˜¯ ï¼ˆæ„é€ å™¨ï¼‰Function çš„å®ä¾‹
// ï¼ˆå…¨å±€å¯¹è±¡ï¼‰Function ä¹Ÿæ˜¯ ï¼ˆæ„é€ å™¨ï¼‰Function çš„å®ä¾‹
Object.__proto__ === Function.prototype // true
Function.__proto__ === Function.prototype // true


// ï¼ˆæ„é€ å™¨ï¼‰Function ä¹Ÿæ˜¯ï¼ˆæ„é€ å™¨ï¼‰Object çš„å®ä¾‹
Function.prototype.__proto__ === Object.prototype // true


// ä»åŸå‹ä¸ŠæŸ¥æ‰¾å±æ€§ï¼Œä¸å¯èƒ½æ— ç»ˆæ­¢åœ°æŸ¥æ‰¾ä¸‹å»ï¼Œé‚£åŸå‹çš„å°½å¤´åœ¨å“ªå‘¢ï¼Ÿ
// ç«™åœ¨åŸå‹é¡¶ç«¯çš„ç”·äººï¼Œæ˜¯å®ƒã€‚
// å‡è®¾æˆ‘ä»¬è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–è€…æ–¹æ³•ï¼Œå¦‚è‹¥å‰é¢çš„åŸå‹ä¸Šå‡æ— æ³•æŸ¥æ‰¾åˆ°ï¼Œæœ€ç»ˆä¼šæ­¢æ­¥äºæ­¤ï¼Œå¹¶è¿”å› undefinedã€‚
Object.prototype.__proto__ // null
```

åœ¨ JavaScript ä¸­è®¿é—®ä¸€ä¸ªå¯¹è±¡å±æ€§ï¼Œå®ƒåœ¨åŸå‹ä¸Šæ˜¯æ€æ ·æŸ¥æ‰¾çš„å‘¢ï¼Ÿ

```js
function Person() {} // æ„é€ å‡½æ•°
var person = new Person() // å®ä¾‹åŒ–å¯¹è±¡
console.log(person.name);  // undefined

// è¿‡ç¨‹å¦‚ä¸‹ï¼š
person // æ˜¯å¯¹è±¡ï¼Œå¯ä»¥ç»§ç»­
person['name'] // ä¸å­˜åœ¨å±æ€§ nameï¼Œç»§ç»­æŸ¥æ‰¾
person.__proto__ // æ˜¯å¯¹è±¡ï¼Œå¯ä»¥ç»§ç»­
person.__proto__['name'] // ä¸å­˜åœ¨å±æ€§ nameï¼Œç»§ç»­æŸ¥æ‰¾
person.__proto__.__proto__ // æ˜¯å¯¹è±¡ï¼Œå¯ä»¥ç»§ç»­
person.__proto__.__proto__['name'] // ä¸å­˜åœ¨å±æ€§ nameï¼Œç»§ç»­æŸ¥æ‰¾
person.__proto__.__proto__.__proto__ // ä¸æ˜¯å¯¹è±¡ï¼Œæ˜¯ null å€¼ã€‚åœæ­¢æŸ¥æ‰¾ï¼Œè¿”å› undefined
```

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ`Object.prototype.__proto__` ä»æœªè¢«åŒ…æ‹¬åœ¨ ECMAScript è¯­è¨€è§„èŒƒä¸­æ ‡å‡†åŒ–ï¼Œä½†å®ƒè¢«å¤§å¤šæ•°æµè§ˆå™¨å‚å•†æ‰€æ”¯æŒã€‚è¯¥ç‰¹æ€§å·²ä» Web æ ‡å‡†ä¸­åˆ é™¤ï¼Œè¯¦æƒ…å¯çœ‹ [Object.prototype.\_\_proto\_\_](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto)ã€‚
>
> åœ¨æ ‡å‡†ä¸­ï¼Œå‡ ä¹ï¼ˆä¾‹å¤–æ˜¯ `Object.create(null)` ï¼Œä¸‹é¢æœ‰è¯´æ˜ï¼‰æ¯ä¸ªå®ä¾‹å¯¹è±¡å†…éƒ¨éƒ½æœ‰ä¸€ä¸ª `[[Prototype]]` å±æ€§ï¼Œè¯¥å±æ€§æŒ‡å‘å¯¹è±¡çš„åŸå‹ï¼Œè€Œä¸”è¯¥å±æ€§å€¼åªä¼šæ˜¯**å¯¹è±¡**æˆ–è€… `null`ã€‚
>
> åœ¨éæ ‡å‡†ä¸‹ï¼Œå¯ä»¥é€šè¿‡ `Object.prototype.__proto__` è®¿é—®ï¼ˆæˆ–è®¾ç½®ï¼‰å®ä¾‹å¯¹è±¡å†…éƒ¨çš„ `[[Prototype]]`ï¼Œè¿™ç§æ–¹å¼å…¶å®æ˜¯ä¸è¢«æ¨èä½¿ç”¨çš„ã€‚ç°åœ¨æ›´è¢«æ¨èä½¿ç”¨çš„æ–¹å¼æ˜¯ `Objec.getPrototypeOf()`/`Object.setPrototypeOf()`ã€‚

>è¯·æ³¨æ„ï¼Œä»¥ä¸Šï¼ˆåŒ…æ‹¬ä¸‹æ–‡ï¼‰æ‰€æŒ‡å¯¹è±¡å‡ä¸æ˜¯é€šè¿‡ `Object.create(null)` å®ä¾‹åŒ–çš„ï¼ˆé™¤ç‰¹æ„è¯´æ˜å¤–ï¼‰ã€‚`Object.create(null)` å®ä¾‹åŒ–çš„å¯¹è±¡æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒå†…éƒ¨æ²¡æœ‰ `[[Prototype]]` å±æ€§ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å…¶ä»–å†…éƒ¨å±æ€§ã€‚ï¼ˆ[Object.create()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create)ï¼‰

```js
var obj = Object.create(null)

var obj1 = Object.create(null)
var obj2 = {}

obj.__proto__ === undefined // true
obj.getPrototypeOf() // æŠ›å‡ºé”™è¯¯ TypeError: obj.getPrototypeOf is not a function
```

æˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°æ‰“å°ä¸€ä¸‹ï¼Œçœ‹ä¸‹ä¸¤è€…çš„åŒºåˆ«ã€‚

![](https://upload-images.jianshu.io/upload_images/5128488-2a156e0f6acfa069.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


JavaScript å¸¸è¢«æè¿°ä¸ºä¸€ç§åŸºäºåŸå‹çš„è¯­è¨€ â€”â€” æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªåŸå‹ï¼ˆ`[[Prototype]]`ï¼‰ï¼Œå¯¹è±¡ä»¥å…¶åŸå‹ä¸ºæ¨¡æ¿ã€ä»åŸå‹ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ã€‚åŸå‹å¯¹è±¡ä¹Ÿå¯èƒ½æ‹¥æœ‰åŸå‹ï¼Œå¹¶ä»ä¸­ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ï¼Œä¸€å±‚ä¸€å±‚ã€ä»¥æ­¤ç±»æ¨ã€‚è¿™ç§å…³ç³»å¸¸è¢«ç§°ä¸ºåŸå‹é“¾ï¼ˆprototype chainï¼‰ã€‚


##### 3. ç»§æ‰¿

å…³äºç»§æ‰¿å†…å®¹ï¼Œå¯çœ‹å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼š[æ·±å…¥ JavaScript ç»§æ‰¿åŸç†](https://github.com/toFrankie/blog/issues/213)ã€‚

##### 4. å¯¹è±¡çš„å†…éƒ¨å±æ€§ï¼ˆInternal propertiesï¼‰

åœ¨è§„èŒƒä¸­ï¼Œå¯¹è±¡çš„å†…éƒ¨æ–¹æ³•å’Œå†…éƒ¨æ’æ§½ä½¿ç”¨åŒæ–¹æ‹¬å· `[[]]` ä¸­åŒ…å«çš„åç§°æ ‡è¯†ï¼Œä¸”é¦–å­—æ¯ä¸ºå¤§å†™ã€‚ä¾‹å¦‚ `[[Prototype]]`ã€`[[Class]]`ã€`[[Extensible]]`ã€`[[Call]]`ã€`[[Scopes]]`ã€`[[FunctionLocation]]` ç­‰ç­‰ã€‚

ä¸‹é¢æŒ‘å‡ ä¸ªæ¥è®²ä¸€ä¸‹ï¼š

4.1 [[Class]]

`[[Class]]` æ˜¯å¯¹è±¡çš„ä¸€ä¸ªå†…éƒ¨å±æ€§ï¼Œå…¶å€¼ä¸ºä»¥ä¸‹**å­—ç¬¦ä¸²**ä¹‹ä¸€ï¼š

* å¸¸è§çš„æœ‰ï¼š`Function`ã€`Object`ã€`Array`ã€`Boolean`ã€`Number`ã€`String`ã€`Symbol`ã€`RegExp`ã€`JSON`ã€`Date`ã€`Math`ã€`Error`ã€`Arguments` ç­‰ã€‚
* æ¯”è¾ƒå°‘ç”¨çš„æœ‰ï¼š`BigInt`ã€`Set`ã€`WeakSet`ã€`Map`ã€`WeakMap`ã€`Reflect`ã€`Promise`ã€`GeneratorFunction`ã€`AsyncFunction`ã€`Window`ã€`Intl`ã€`WebAssembly`ï¼Œä»¥åŠæ´¾ç”Ÿäº `HTMLElement` çš„ï¼ˆå¦‚ `HTMLScriptElement` ï¼‰ç­‰ç­‰ã€‚
* å‡ ä¹æ‰€æœ‰[æ ‡å‡†å†…ç½®å¯¹è±¡]()ï¼Œéƒ½æœ‰ç‰¹å®šçš„ç±»å‹ã€‚å®åœ¨å¤ªå¤šäº†...

æˆ‘ä»¬éƒ½çŸ¥é“ `typeof` æ— æ³•åˆ¤æ–­å¯¹è±¡çš„å…·ä½“ç±»å‹ï¼Œæ— è®ºæ˜¯ `typeof {}`ã€`typeof []`ã€è¿˜æ˜¯ `typeof Math`  éƒ½è¿”å› `"object"`ã€‚ä½†æœ‰äº† `[[Class]]` å±æ€§ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒæ¥åˆ¤æ–­å¯¹è±¡çš„ç±»å‹äº†ã€‚è®¿é—® `[[Class]]` çš„å”¯ä¸€æ–¹æ³•æ˜¯é€šè¿‡é»˜è®¤çš„ `toString()` æ–¹æ³•ï¼ˆè¯¥æ–¹æ³•æ˜¯é€šç”¨çš„ï¼‰ï¼š

> Object.prototye.toString()
> * å¦‚æœå‚æ•° `undefined`ï¼Œåˆ™è¿”å› `[object Undefined]` å­—ç¬¦ä¸²ï¼›
> * å¦‚æœå‚æ•° `null`ï¼Œåˆ™è¿”å› `[object Null]` å­—ç¬¦ä¸²ï¼›
> * å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™è¿”å› `"[object " + obj.[[Class]] + "]"` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `[object Array]`ï¼›
> * å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œåˆ™ä¼šå…ˆå°†å…¶è½¬æ¢ä¸ºç›¸åº”çš„å¯¹è±¡ï¼Œç„¶åæŒ‰ç…§ä»¥ä¸Šçš„è§„åˆ™è¾“å‡ºã€‚

ä»¥ä¸‹å°è£…äº†è·å–å¯¹è±¡ç±»å‹çš„æ–¹æ³•ï¼š

```js
function getClass(x) {
  const { toString } = Object.prototype
  const str = toString.call(x)
  return /^\[object (.*)\]$/.exec(str)[1]
}

getClass(null) // "Null"
getClass(undefined) // "Undefined"
getClass({}) // "Object"
getClass([]) // "Array"
getClass(JSON) // "JSON"
getClass(() => {}) // "Function"
;(function() { return getClass(arguments) })() // "Arguments"
```

4.2 [[Construct]]

 ä¸€ä¸ªå¯¹è±¡é‡Œï¼Œå¦‚è‹¥æ²¡æœ‰ `[[construct]]` å±æ€§ï¼Œæ˜¯æ— æ³•ä½¿ç”¨ `new` å…³é”®å­—è¿›è¡Œæ„é€ çš„ã€‚

### å››ã€ç±»å‹è½¬æ¢

åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ`==`ï¼‰å»æ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°æ˜¯å¦ç›¸ç­‰ã€‚å½“ä¸¤ä¸ªæ“ä½œæ•°ä¸€ä¸ªæ˜¯å¼•ç”¨ç±»å‹ï¼Œå¦ä¸€ä¸ªæ˜¯åŸå§‹ç±»å‹çš„æ—¶å€™ï¼Œå‰è€…ä¼šå…ˆè½¬æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œå†æ¯”è¾ƒã€‚

é‚£ä¹ˆï¼Œå¼•ç”¨ç±»å‹æ˜¯å¦‚ä½•è½¬æ¢ä¸ºåŸå§‹ç±»å‹çš„å‘¢ï¼Ÿ


> å…³äº JavaScript ç±»å‹è½¬æ¢çš„å†…å®¹ï¼Œå·²ç»å•ç‹¬å†™äº†ä¸€ç¯‡æ–‡ç« è¯¦ç»†åœ°ä»‹ç»äº†ï¼Œè¯·çœ‹ ğŸ‘‰ [Type Conversion è¯¦è§£](https://github.com/toFrankie/blog/issues/242)ã€‚



æœªå®Œå¾…ç»­...

### å‚è€ƒ

* [JavaScriptâ€™s type system](https://2ality.com/2013/09/types.html)
* [Categorizing values in JavaScript](https://2ality.com/2013/01/categorizing-values.html)
* [Primitive MDN](https://developer.mozilla.org/en-US/docs/Glossary/Primitive)
* [ToPrimitive Abstract Operation](https://262.ecma-international.org/#sec-toprimitive)
* [OrdinaryToPrimitive Abstract Operation](https://262.ecma-international.org/#sec-ordinarytoprimitive)
