---
title: 联合类型与交叉类型的错觉
number: '#366'
link: 'https://github.com/toFrankie/blog/issues/366'
created_at: '2025-08-29 12:01:27'
updated_at: '2025-08-29 16:32:14'
labels:
  - TS
  - '2025'
---
## 前言

- 联合类型：要么 A，要么 B（只要满足任意一个分支）
- 交叉类型：必须同时满足 A 和 B（必须满足所有分支）

```ts
type Union = A | B

type Intersection = A & B
```

看起来，联合类型像数学上的“并集”，交叉类型像“交集”。

## 符合直觉

▼ 要么是字符串，要么是数字，这是符合直觉的。

```ts
type DataUnion = string | number

let data: DataUnion

data = 'abc' // ✅
data = 123 // ✅
```
▼ 由于不可能存在同时满足是字符串，也是数字的值，因此 DataIntersection 类型是 never。这也是符合直觉的。

```ts
type DataIntersection = string & number

let data: DataIntersection

data = 'abc' // ❌ Type '"abc"' is not assignable to type 'never'.
data = 123 // ❌ Type '123' is not assignable to type 'never'.
```

▼ 以下示例是符合直觉的，Shape 就应该保持一致。

```ts
type Point = { x: number }

let p: Point

p = { x: 1 } // ✅
p = { y: 2 } // ❌ Object literal may only specify known properties, and 'y' does not exist in type 'Point'.
p = { x: 1, y: 2 } // ❌ Object literal may only specify known properties, and 'y' does not exist in type 'Point'.
```

## 联合类型的反直觉

▼ 示例一

```ts
type Point = { x: number }

let p: Point

p = { x: 1 } // ✅
p = { y: 2 } // ❌ Object literal may only specify known properties, and 'y' does not exist in type 'Point'.
p = { x: 1, y: 2 } // ❌ Object literal may only specify known properties, and 'y' does not exist in type 'Point'.
```

▼ 示例二

```ts
type PointUnion = { x: number } | { y: number }

let p: PointUnion

p = { x: 1 } // ✅
p = { y: 2 } // ✅
p = { x: 1, y: 2 } // ✅ 你刚接触 TS 时，第一反应会不会觉得这里有点奇怪？
```

▼ 示例三

```ts
type PointUnion = { x: number } | { y: number }

function showPoint(point: PointUnion) {
  const x = point.x ?? 0 // ❌ Property 'x' does not exist on type '{ y: number; }'.
  const y = point.y ?? 0 // ❌ Property 'y' does not exist on type '{ x: number; }'.
  return `(${x}, ${y})`
}
```

1. 示例一是符合直觉的，赋值含 `y` 属性的值应该报错。
2. 结合第一点，示例二中 `p = { x: 1, y: 2 }` 不报错是反直觉的，它跟 `{ x: number }`、`{ y: number }` 都不太像，也“似乎”不符合联合类型「要么 A，要么 B」的结论。
3. 访问属性 `point.x`、`point.y` 的报错是符合直觉的，毕竟一个没有 `x`、一个没有 `y`。

结合起来看，我认为是反直觉的。

未完待续...
